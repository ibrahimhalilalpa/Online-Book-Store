(self.webpackChunk_quizlet_web_index=self.webpackChunk_quizlet_web_index||[]).push([["ads"],{"./app/j/ads/ads.entry.tsx":(e,t,i)=>{"use strict";var s=i("./app/j/ab_tests/QMeasure.ts");const n=window;i("./node_modules/core-js/modules/es.array.iterator.js"),i("./node_modules/core-js/modules/web.dom-collections.iterator.js"),i("./node_modules/core-js/modules/web.url-search-params.js");var a=i("./app/j/ads/AdsHelper.ts");let r;!function(e){e.AD_TEST_ENABLED="dbgate",e.AD_REFRESH_COUNT="arc",e.AD_REFRESH_COUNT_BUCKETS="ref",e.AGE="a",e.AGE_RANGE="g",e.AGE_RANGE_PREDICTED="gp",e.AUDIENCE="au",e.CAMPAIGN="campaign",e.CHILD_DIRECTED="childDirected",e.CONSENT_REGION="cr",e.CONTENT_CATEGORY_CERTIFICATION_LEVEL_1="ct_level1_cert",e.CONTENT_CATEGORY_CERTIFICATION_LEVEL_2="ct_level2_cert",e.CONTENT_CATEGORY_CERTIFICATION_LEVEL_3="ct_level3_cert",e.CONTENT_CATEGORY_CERTIFICATION_LEVEL_4="ct_level4_cert",e.CONTENT_CATEGORY_CERTIFICATION_LEVEL_5="ct_level5_cert",e.CONTENT_CATEGORY_LEVEL_1="ct_level1",e.CONTENT_CATEGORY_LEVEL_2="ct_level2",e.CONTENT_CATEGORY_LEVEL_3="ct_level3",e.CONTENT_CATEGORY_LEVEL_4="ct_level4",e.CONTENT_CATEGORY_LEVEL_5="ct_level5",e.CONTENT_CATEGORY_LEVEL_6="ct_level6",e.FRIENDLY_IFRAME="fifr",e.GRADE_LEVELS="gl",e.IS_ELIGIBLE_FOR_FREE_TRIAL="iefft",e.IS_FIRST_LOGGED_IN_SESSION="f",e.IS_PARENT="par",e.IS_TEACHER="t",e.LOCALE="n",e.LOGGED_IN_STATUS="l",e.MARKETPLACE_HOUSE_ADS="mad",e.MODERNIZE_STUDY_MODES="msm",e.ONE_TRUST="one_trust",e.ONE_TRUST_TRACK="ot",e.PAGE_ACTION="pa",e.PAGE_DEPTH="pd",e.PLACEHOLDER_ADS_ENABLED="dbgpae",e.PLATFORM="p",e.PROSEMIRROR_BUNDLE_PERF_TEST="pbpt",e.PWT_VERSION_ID="pwtverid",e.RANDOM_PAGE_VIEW="rpv",e.REQUESTED_WITHOUT_BIDS="rwb",e.RESIZE="rsz",e.SCREEN_HEIGHT="sh",e.SCREEN_WIDTH="sw",e.SEARCH_RESULT_DESKTOP_TEST="srp_embed",e.SET_ID="set_id",e.SET_TERMS_COUNT="stc",e.SUBS_OFFER_0523="so",e.TEACHER_CREATED_SET="tcs",e.TESTING_VARIABLES="testing_variables",e.UPGRADE_EXPIRATION_DATE_RANGE="rd",e.UPGRADE_TYPE="u",e.VERSION="v",e.OW_SCREEN_HEIGHT="sh",e.OW_SCREEN_WIDTH="sw"}(r||(r={}));var d=i("./node_modules/lodash/nth.js"),o=i.n(d),l=i("./node_modules/lodash/groupBy.js"),g=i.n(l),h=i("./node_modules/lodash/defaultTo.js"),u=i.n(h),c=(i("./node_modules/core-js/modules/es.json.stringify.js"),i("./node_modules/core-js/modules/es.string.replace.js"),i("./node_modules/core-js/modules/web.url.to-json.js"),i("./node_modules/core-js/modules/es.promise.js"),i("./node_modules/core-js/modules/es.array.reduce.js"),i("./node_modules/core-js/modules/es.array.sort.js"),i("./app/j/ads/enums/AdsNames.ts")),p=i("./app/j/ads/enums/AdsTypes.ts"),E=i("./app/j/ads/sizes/video.ts"),_=i("./app/j/ads/utils/screenSizes.ts"),m=i("./node_modules/invariant/browser.js"),f=i.n(m);const A={ad1x1:[1,1],ad81x31:[81,31],ad120x240:[120,240],ad120x600:[120,600],ad160x600:[160,600],ad180x150:[180,150],ad234x60:[234,60],ad250x250:[250,250],ad300x50:[300,50],ad300x100:[300,100],ad300x250:[300,250],ad300x600:[300,600],ad320x50:[320,50],ad320x100:[320,100],ad336x280:[336,280],ad400x300:[400,300],ad426x240:[426,240],ad468x60:[468,60],ad640x360:[640,360],ad640x480:[640,480],ad728x90:[728,90],ad970x90:[970,90],ad970x250:[970,250],fluid:"fluid"},T=[],S={[p.D.BANNER]:[A.ad728x90],[p.D.MOBILE_HORIZONTAL_STRIP]:[A.ad320x50],[p.D.NATIVE]:[A.fluid],[p.D.MOBILE_RECTANGLE]:[A.ad320x50],[p.D.RECTANGLE]:[A.ad300x250],[p.D.SIDEBAR]:[A.ad160x600],[p.D.VIDEO]:[E.x.ad400x300v]},v=(p.D.BANNER,E.x.ad480x270v,p.D.RECTANGLE,E.x.ad400x300v,p.D.SIDEBAR,E.x.ad300x600v,p.D.VIDEO,E.x.ad400x300v,p.D.RECTANGLE,p.D.SIDEBAR,p.D.VIDEO,{[p.D.BANNER]:[[_.r.medium,[A.ad728x90]],[_.r.remaining,T]],[p.D.MOBILE_HORIZONTAL_STRIP]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]],[p.D.MOBILE_RECTANGLE]:[[_.r.medium,T],[_.r.remaining,[A.ad300x250]]],[p.D.NATIVE]:[[_.r.remaining,[A.fluid]]],[p.D.RECTANGLE]:[[_.r.medium,[A.ad300x250]],[_.r.remaining,T]],[p.D.SIDEBAR]:[[_.r.medium,[A.ad160x600]],[_.r.remaining,T]]}),R={[p.D.SIDEBAR]:[[_.r.large,[A.ad120x600,A.ad160x600,A.ad250x250,A.ad300x250,A.ad300x600]],[_.r.medium,[A.ad120x600,A.ad160x600]],[_.r.remaining,T]]},b=[[_.r.medium,T],[_.r.small,[A.ad300x50,A.ad300x250,A.ad320x50,A.ad468x60]],[_.r.remaining,[A.ad250x250,A.ad300x50,A.ad300x250,A.ad320x50]]],P=[[_.r.medium,T],[_.r.small,[A.ad300x50,A.ad300x250,A.ad320x50,A.ad426x240,A.ad468x60]],[_.r.remaining,[A.ad250x250,A.ad300x50,A.ad300x250,A.ad320x50]]],y=[[_.r.veryLarge,[A.ad320x100,A.ad468x60,A.ad728x90]],[_.r.large,[A.ad300x50,A.ad320x100,A.ad468x60]],[_.r.medium,[A.ad300x50,A.ad320x100,A.ad468x60]],[_.r.remaining,T]],O=[[_.r.veryLarge,[A.ad640x360,A.ad728x90]],[_.r.large,[A.ad300x50,A.ad320x100,A.ad468x60,A.ad640x360]],[_.r.medium,[A.ad300x50,A.ad320x100,A.ad426x240,A.ad468x60]],[_.r.remaining,T]],D=[[_.r.veryLarge,[A.ad728x90]],[_.r.large,[A.ad640x360]],[_.r.medium,[A.ad300x250,A.ad320x50]],[_.r.remaining,T]],w=[[_.r.medium,T],[_.r.tiny,[A.ad320x50,A.ad300x250]],[_.r.remaining,T]],M=[[_.r.veryLarge,[A.ad120x600,A.ad160x600,A.ad250x250,A.ad300x250,A.ad300x600]],[_.r.large,[A.ad120x600,A.ad160x600]],[_.r.remaining,T]],C=e=>e.map((e=>{let[t,i]=e;return i===T?[t,i]:[t,[A.fluid,...i]]})),I={[c.h.CLASS_DASHBOARD_EMBEDDED_01]:[[_.r.veryLarge,[A.fluid,A.ad468x60]],[_.r.large,[A.fluid,A.ad320x50]],[_.r.medium,[A.fluid,A.ad320x50,A.ad300x250]],[_.r.remaining,T]],[c.h.CLASS_DASHBOARD_EMBEDDED_02]:[[_.r.veryLarge,[A.ad468x60]],[_.r.large,[A.ad320x50]],[_.r.medium,[A.ad320x50,A.ad300x250]],[_.r.remaining,T]],[c.h.CLASS_DASHBOARD_EMBEDDED_MWEB_01]:[[_.r.medium,T],[_.r.small,[A.fluid,A.ad320x50,A.ad300x250]],[_.r.verySmall,[A.fluid,A.ad320x50,A.ad300x250]],[_.r.tiny,[A.fluid,A.ad300x250]],[_.r.remaining,T]],[c.h.CLASS_DASHBOARD_EMBEDDED_MWEB_02]:[[_.r.medium,T],[_.r.small,[A.ad320x50,A.ad300x250]],[_.r.verySmall,[A.ad320x50,A.ad300x250]],[_.r.tiny,[A.ad300x250]],[_.r.remaining,T]],[c.h.CLASS_DASHBOARD_SIDEBAR]:M,[c.h.CREATE_SET_HEADER]:[[_.r.veryLarge,[A.ad728x90,A.ad468x60,A.ad320x50,A.ad234x60]],[_.r.large,[A.ad468x60,A.ad320x50,A.ad234x60]],[_.r.medium,[A.ad320x50,A.ad234x60]],[_.r.remaining,T]],[c.h.EXPLANATIONS_EXERCISE_EMBED_DESKTOP_01]:[[_.r.veryLarge,[A.fluid,A.ad728x90,A.ad640x360]],[_.r.large,[A.fluid,A.ad300x250,A.ad320x50]],[_.r.medium,[A.fluid,A.ad300x250,A.ad320x50]],[_.r.remaining,T]],[c.h.EXPLANATIONS_EXERCISE_EMBED_MWEB_01]:[[_.r.medium,T],[_.r.tiny,[A.fluid,A.ad320x50,A.ad300x250]],[_.r.remaining,T]],[c.h.EXPLANATIONS_EXERCISE_SIDEBAR]:[[_.r.large,[A.ad300x600,A.ad300x250]],[_.r.medium,[A.ad160x600]],[_.r.remaining,T]],[c.h.EXPLANATIONS_QUESTION_SIDEBAR]:[[_.r.large,[A.ad300x600,A.ad300x250]],[_.r.medium,[A.ad160x600]],[_.r.remaining,T]],[c.h.EXPLANATIONS_QUESTION_EMBED_DESKTOP_01]:[[_.r.veryLarge,[A.fluid,A.ad728x90,A.ad640x360]],[_.r.large,[A.fluid,A.ad300x250,A.ad320x50]],[_.r.medium,[A.fluid,A.ad300x250,A.ad320x50]],[_.r.remaining,T]],[c.h.EXPLANATIONS_QUESTION_EMBED_MWEB_01]:[[_.r.medium,T],[_.r.tiny,[A.fluid,A.ad320x50,A.ad300x250]],[_.r.remaining,T]],[c.h.EXPLANATIONS_TEXTBOOK_SIDEBAR]:[[_.r.large,[A.ad300x600,A.ad300x250]],[_.r.medium,[A.ad160x600]],[_.r.remaining,T]],[c.h.EXPLANATIONS_TEXTBOOK_EMBED_DESKTOP_01]:[[_.r.veryLarge,[A.fluid,A.ad728x90,A.ad640x360]],[_.r.large,[A.fluid,A.ad640x360]],[_.r.medium,[A.fluid,A.ad300x250,A.ad320x50]],[_.r.remaining,T]],[c.h.EXPLANATIONS_TEXTBOOK_EMBED_DESKTOP_02]:D,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_DESKTOP_03]:D,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_DESKTOP_04]:D,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_DESKTOP_05]:D,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_DESKTOP_06]:D,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_MWEB_01]:[[_.r.medium,T],[_.r.tiny,[A.fluid,A.ad320x50,A.ad300x250]],[_.r.remaining,T]],[c.h.EXPLANATIONS_TEXTBOOK_EMBED_MWEB_02]:w,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_MWEB_03]:w,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_MWEB_04]:w,[c.h.EXPLANATIONS_TEXTBOOK_EMBED_MWEB_05]:w,[c.h.FOLDER_SIDEBAR]:M,[c.h.HOMEPAGE_MWEB_EMBEDDED]:[[_.r.large,T],[_.r.remaining,[A.ad320x50]]],[c.h.HOMEPAGE_SIDEBAR]:M,[c.h.MATCH_MWEB]:[[_.r.medium,T],[_.r.remaining,[A.ad300x250]]],[c.h.LEADERBOARD_MWEB]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]],[c.h.PROFILE_SIDEBAR]:M,[c.h.SEARCH_EMBED_DESKTOP_01]:[[_.r.veryLarge,[A.fluid,A.ad728x90]],[_.r.large,[A.fluid,A.ad728x90]],[_.r.medium,[A.fluid,A.ad728x90]],[_.r.remaining,T]],[c.h.SEARCH_EMBED_MWEB_01]:[[_.r.medium,T],[_.r.remaining,[A.fluid,A.ad320x50]]],[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_01]:C(O),[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_02]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_03]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_04]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_05]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_06]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_07]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_08]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_09]:y,[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_10]:y,[c.h.SET_PAGE_EMBED_MWEB_MULTI_01]:C(P),[c.h.SET_PAGE_EMBED_MWEB_MULTI_02]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_03]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_04]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_05]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_06]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_07]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_08]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_09]:b,[c.h.SET_PAGE_EMBED_MWEB_MULTI_10]:b,[c.h.SET_PAGE_STICKY_AD_MWEB]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]],[c.h.SET_PAGE_FOOTER]:[[_.r.large,[A.ad970x250,A.ad970x90,A.ad728x90]],[_.r.medium,[A.ad728x90]],[_.r.small,[A.ad468x60]],[_.r.remaining,[A.ad320x50]]],[c.h.SET_SIDEBAR_V4]:[[_.r.largeAndTall,[A.ad300x250,A.ad300x600]],[_.r.large,[A.ad300x250]],[_.r.medium,[A.ad120x600,A.ad160x600]],[_.r.remaining,T]],[c.h.SPELL_MWEB_FOOTER]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]],[c.h.STUDY_MODE_AD]:[[_.r.mediumAndVeryTall,[A.fluid,A.ad300x600,A.ad300x250,A.ad640x360]],[_.r.medium,[A.fluid,A.ad300x600,A.ad300x250,A.ad400x300,A.ad640x360]],[_.r.tiny,[A.fluid,A.ad300x250,A.ad400x300]],[_.r.remaining,T]],[c.h.LEARN_REWARDED_VIDEO]:[[_.r.remaining,[E.x.ad640x360v]]],[c.h.TEST_MWEB]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]],[c.h.TEST_STUDY_MODE_AD]:[[_.r.large,[A.fluid,A.ad728x90,A.ad640x360]],[_.r.medium,[A.fluid,A.ad640x360]],[_.r.verySmall,[A.ad400x300]],[_.r.remaining,[A.ad320x50]]],[c.h.WRITE_MWEB]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]]},L={[c.h.SET_MWEB_STRIP_V3]:[[_.r.medium,T],[_.r.remaining,[A.ad320x50]]],[c.h.SET_PAGE_EMBED_DESKTOP_MULTI_01]:[[_.r.veryLarge,[A.fluid,A.ad320x100,A.ad468x60,A.ad728x90]],[_.r.large,[A.fluid,A.ad300x50,A.ad320x100,A.ad468x60]],[_.r.medium,[A.fluid,A.ad300x50,A.ad320x100,A.ad468x60]],[_.r.remaining,T]],[c.h.SET_PAGE_EMBED_MWEB_MULTI_01]:[[_.r.medium,T],[_.r.verySmall,[A.fluid,A.ad300x50,A.ad300x250,A.ad320x50,A.ad468x60,A.ad400x300]],[_.r.remaining,[A.fluid,A.ad250x250,A.ad300x250,A.ad320x50]]],[c.h.SET_SIDEBAR_V4]:[[_.r.large,[A.ad120x600,A.ad160x600,A.ad250x250,A.ad300x250,A.ad300x600]],[_.r.medium,[A.ad120x600,A.ad160x600]],[_.r.remaining,T]]};function x(e,t){if(void 0===t&&(t={type:p.D.SIDEBAR,isBCS:!1,isFlexible:!1,noVariant:!1}),t.isBCS){const t=L[e];if(t)return t}if(t.isFlexible){const i=I[e];if(i)return i;const s=R[t.type];if(s)return s}const i=v[t.type];return f()(i,"Size map should be available"),i}function B(e,t,i){return void 0===t&&(t={type:p.D.SIDEBAR,isBCS:!1,isFlexible:!1,noVariant:!1}),x(e,t).filter((e=>{let[[t,s]]=e;return t<=i.width&&s<=i.height})).sort(((e,t)=>{let[[i,s]]=e,[[n,a]]=t;return i<n?1:i>n?-1:s<a?1:s>a?-1:0})).slice(0,1)}const N={[c.h.STUDY_MODE_AD]:[[_.r.medium,{name:"StudyModeAd",adSize:A.ad640x360}],[_.r.remaining,{name:"StudyModeAd",adSize:A.ad400x300}]]};function k(e,t){var i,s,n,a;return null==(i=N[e])||null==(s=i.filter((e=>{let[[i,s]]=e;return i<=t.width&&s<=t.height})))||null==(n=s.sort(((e,t)=>{let[[i,s]]=e,[[n,a]]=t;return i<n?1:i>n?-1:s<a?1:s>a?-1:0})))||null==(a=n[0])?void 0:a[1]}class V{constructor(e){this.config=e}getIMASdk(){var e;const t=window;return null==t||null==(e=t.google)?void 0:e.ima}renderBid(e,t,i){const s=e.adUnitCode,n=e.width,a=e.height,r=this.getIMASdk(),d=document.getElementById(s);if(!r)return void(null==i||i(new Error("ima sdk not ready")));if(!d)return void(null==i||i(new Error("ad container not on page")));if(!e.vastXml)return void(null==i||i(new Error("prebid bid missing vast xml")));if(n<=0||a<=0)return void(null==i||i(new Error("invalid size in bid")));this.config.vpaidEnabled&&r.settings.setVpaidMode(r.ImaSdkSettings.VpaidMode.ENABLED);const o=new r.AdDisplayContainer(d),l=new r.AdsLoader(o),g=new r.AdsRequest;this.dependencies={adDisplayContainer:o,adsLoader:l},g.adsResponse=e.vastXml,g.linearAdSlotWidth=n,g.linearAdSlotHeight=a,g.nonLinearAdSlotWidth=n,g.nonLinearAdSlotHeight=a,l.addEventListener(r.AdErrorEvent.Type.AD_ERROR,(e=>{null==i||i(e.getError())}),!1),l.addEventListener(r.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{const s=e.getAdsManager({currentTime:0,duration:30});this.dependencies&&(this.dependencies.adsManager=s),this.config.muted&&s.setVolume(0),s.addEventListener(r.AdErrorEvent.Type.AD_ERROR,(e=>{null==i||i(e.getError())})),s.addEventListener(r.AdEvent.Type.COMPLETE,(()=>{null==t||t()})),o.initialize(),s.init(n,a,r.ViewMode.NORMAL),s.start()}),!1),l.requestAds(g)}destroy(){var e;this.dependencies&&(this.dependencies.adDisplayContainer.destroy(),this.dependencies.adsLoader.destroy(),null==(e=this.dependencies.adsManager)||e.destroy(),this.dependencies=null)}}const W=new class{constructor(){this.adNameToRenderer={},this.onWillRenderHooks={},this.onCompleteHooks={},this.onErrorHooks={}}renderBid(e,t){var i,s,n;const a=e.adUnitCode.startsWith("php-")?e.adUnitCode.replace("php-",""):e.adUnitCode.replace("dfp-","");null==(i=this.adNameToRenderer[a])||i.destroy();const r=new V(t);this.adNameToRenderer[a]=r,null==(s=(n=this.onWillRenderHooks)[a])||s.call(n),r.renderBid(e,(()=>{var e,t;r.destroy(),null==(e=(t=this.onCompleteHooks)[a])||e.call(t),this.clearHooks(a)}),(e=>{var t,i;r.destroy(),null==(t=(i=this.onErrorHooks)[a])||t.call(i,e),this.clearHooks(a)}))}setOnWillRenderHook(e,t){this.onWillRenderHooks[e]=t}setOnCompleteHook(e,t){this.onCompleteHooks[e]=t}setOnErrorHook(e,t){this.onErrorHooks[e]=t}clearHooks(e){delete this.onWillRenderHooks[e],delete this.onCompleteHooks[e],delete this.onErrorHooks[e]}};var H=i("./app/j/ads/types.ts"),j=i("./app/j/ads_core/utils/logToConsole.ts"),G=i("./app/j/constants/TimeConstants.ts");const F=60*G.sU,U=e=>{const t=e.indexOf("upr");if(!(-1!==t))return{enabled:!1};const i=e.substr(t+3,3);return{enabled:!0,minUSUPRFloor:(()=>{switch(i){case"05c":return.05;case"10c":return.1;case"15c":return.15;case"20c":return.2;case"25c":return.25;case"30c":return.3;default:return 0}})()}},z=e=>{const t=e.indexOf("Ow");if(!(-1!==t))return{enabled:!1};const i=e.substr(t+2);return{enabled:!0,mult:(()=>{switch(i){case"Quarterx":return.25;case"Halfx":return.5;case"1x":default:return 1;case"2x":return 2}})()}},Z=(e,t)=>{(0,j.Xq)(e,"Flooring",t)},K=e=>({partners:{adX:U(e),openWrap:z(e)},staticMultiplier:1,floors:{geoc_mult:{us:1,ca:.6,gb:.25,au:.57,se:.18,jp:.22,ch:.56,in:.13,mx:.18,ru:.12,kr:.2,fr:.22,ae:.6,nl:.2,de:.31,es:.15,sg:.4,other:.07}}}),q=(e,t,i)=>{var s,n,a;const r="pubmaticServer"===i?"pubmatic":i;return null!=(s=null==e||null==(n=e.base_floors)||null==(a=n[t])?void 0:a[r])?s:.1},Q=(e,t)=>{var i,s;const n=Math.min(t,20);return null!=(i=null==e||null==(s=e.ref_mult)?void 0:s[n])?i:1},X=(e,t,i,s)=>{const n=((e,t)=>{var i,s;if(t<1)return 1;const n=Math.min(Math.round(t),20);return null!=(i=null==e||null==(s=e.pd_mult)?void 0:s[n])?i:1})(e,t),a=((e,t)=>{var i,s;const n=null==e?void 0:e.geoc_mult;return null!=(i=null!=(s=null==n?void 0:n[t])?s:null==n?void 0:n.other)?i:1})(e,i),r=((e,t)=>{var i,s;return null!=(i=null==e||null==(s=e.bn_mult)?void 0:s[t])?i:1})(e,s),d=(e=>{var t,i;const s=(new Date).getUTCHours();return null!=(t=null==e||null==(i=e.hod_mult)?void 0:i[s])?t:1})(e),o=(e=>{var t,i;let s=(new Date).getUTCDay();return 0===s&&(s=7),null!=(t=null==e||null==(i=e.dow_mult)?void 0:i[s])?t:1})(e),l=[n,a,r,d,o];Z("Calculating static multiplier",{pdMult:n,geoMult:a,browserMult:r,hodMult:d,dowMult:o});let g=1;for(let h=0;h<l.length;h++)g*=l[h];return g},Y=e=>Math.round(100*e+Number.EPSILON)/100,J=(e,t,i,s,n)=>{const a=n*Q(e,s),r=q(e,t,i);return Y(r*a)},$=e=>"us"===e?.1:.03,ee=(e,t,i,s,n,a,r)=>{const d="control"!==r?((e,t,i)=>{var s,n,a,r;return null!=(s=null==(n=e.decisioning)||null==(a=n[i])||null==(r=a[t])?void 0:r.cpm_sum_per_1000_imps)?s:"control"})(e,t,r):a,o=K(d);return o.floors=e,o.staticMultiplier=X(e,n,s,i),o},te=["33across","aol","nobid","onedisplay","onemobile","verizon"],ie=e=>(t,i)=>(i[e]=t,i),se=ie("bidFloor"),ne={appnexus:ie("reserve"),districtmDMX:ie("floor"),ix:(e,t)=>(t.bidFloorCur="USD",ie("bidFloor")(e,t)),onedisplay:se,onemobile:se,openx:ie("customFloor"),pubmatic:(e,t)=>ie("kadfloor")(""+Y(e),t),pubmaticServer:(e,t)=>ie("kadfloor")(""+Y(e),t),smartadserver:ie("bidfloor"),sonobi:ie("floor"),sovrn:ie("bidfloor"),triplelift:ie("floor")},ae=(e,t,i,s,n,a,r)=>{n.forEach((n=>{const d="function"==typeof s?s(n.code):s,o=Q(e,d),l=t*o;n.bids="control"!==a?n.bids.map(((e,t,i,s)=>n=>{const a=ne[n.bidder];if(void 0===a)return n;const r=e[t];let d=s;return r&&(d=r[i]||s),Z("Applying $"+d+" to "+n.bidder+" for "+t),n.params=a(d,n.params),n})(e,n.code,d,r)):n.bids.map(((e,t,i,s)=>n=>{const a=ne[n.bidder];if(void 0===a)return n;const r=Y(q(e,s,n.bidder)*i*t);return Z("Applying $"+r+" to "+n.bidder+" for "+s),n.params=a(r,n.params),n})(e,l,i,n.code))}))},re={},de=(e,t,i)=>{t.forEach((t=>{var s;const n=t.code.replace("dfp-","");if(null==(s=e.registeredAds[n])?void 0:s.isOutstream){const[e,s]=(0,a.EQ)(),r=k(n,{height:s,width:e});if(r){t.renderer={url:"https://imasdk.googleapis.com/js/sdkloader/ima3.js",render:e=>{W.renderBid(e,{vpaidEnabled:!0,muted:!0})},backupOnly:i};const e={h:r.adSize[1],playerSize:r.adSize,skip:1,skipmin:5,minduration:5,mimes:["video/mp4","application/javascript"],playerHeight:r.adSize[1],skipafter:5,maxduration:120,w:r.adSize[0],context:"outstream",playerWidth:r.adSize[0],protocols:[2,3,5,6],api:[1,2],linearity:[2]};t.mediaTypes.video=e,t.bids.forEach((t=>{t.params.video=e}))}}}))};let oe;!function(e){e.BID_RECEIVED="HookForBidReceived",e.PREBID_SET_CONFIG="HookForPrebidSetConfig",e.PREBID_REQUEST_BIDS="HookForPrebidRequestBids",e.JS_LOADED="jsLoaded"}(oe||(oe={}));const le=function(e,t,i,s){void 0===s&&(s=!1);const n=s?null:e[t];e[t]=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];null==n||n(...t),i(...t)}},ge=(e,t,i,s)=>{le(e,oe.BID_RECEIVED,((e,n)=>{((e,t)=>{var i;const s=t.adUnitCode.replace("dfp-","");null!=(i=t.ad)&&i.length&&!(e=>"teads"!==e.bidder&&("triplelift"!==e.bidder||"tlx"!==e.tl_source))(t)&&s in re&&re[s].add(t.ad)})(0,n),((e,t,i)=>{const s=t.floors,n=t.staticMultiplier;if(!t.partners.openWrap.enabled||e.cpm<=0||!s)return;if(te.includes(e.bidder))return;const r=(0,a.RK)(i,e.adUnitCode,H.HS.PostAuction),d=J(s,e.adUnitCode,e.bidder,r,n);e._requestFloor=d,e._requestFloorRespected=e.cpm>=d})(n,t(),s._winningBids),i&&s.logOpenWrapBid(n)}))},he=(e,t,i)=>{const s="experiment"===i.getVariationAndEnroll("EnablePwtMfsOutstream[default,ads]");le(e,oe.PREBID_REQUEST_BIDS,(e=>{((e,t)=>{const i=e.keyValues[r.GRADE_LEVELS],s=e.keyValues[r.IS_TEACHER];(i||s)&&t.forEach((e=>{e.bids=e.bids.map((e=>("appnexus"===e.bidder&&(e.params.keywords=e.params.keywords||{},e.params.keywords[r.GRADE_LEVELS]=i),"yahoossp"===e.bidder&&(e.params.kvp=e.params.kvp||{},e.params.kvp[r.IS_TEACHER]=s,e.params.kvp[r.GRADE_LEVELS]=i),e)))}))})(t,e),s&&de(t,e,!0)}))};i("./node_modules/core-js/modules/es.array.flat.js"),i("./node_modules/core-js/modules/es.array.unscopables.flat.js");let ue;!function(e){e.A9="A9",e.PWT="PWT"}(ue||(ue={}));var ce=i("./app/j/global/Rollbar.ts");var pe=i("./node_modules/nullthrows/nullthrows.js"),Ee=i.n(pe),_e=i("./app/j/utils/tamperProofNow.ts");const me=ue.A9,fe={},Ae={name:me,timeoutMs:1300,async init(e,t,i,s,n){if("undefined"==typeof window)throw new Error("attempted to initialize a9 bidder in the server");if(!window.apstag){const e=[];window.apstag={init(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];e.push(["i",i])},fetchBids(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];e.push(["f",i])},setDisplayBids(){},targetingKeys:()=>[],dpa(t){e.push(["di",t])},rpa(t){e.push(["ri",t])},upa(t){e.push(["ui",t])},_Q:e}}if(i)n&&QWait("Quizlet.apstag",n);else{const i={adServer:"googletag",bidTimeout:t,deals:!0,pubID:e,simplerGPT:!1,videoAdServer:"DFP"};if(s)try{const e=await async function(e,t){return void 0===t&&(t=500),new Promise(((i,s)=>{setTimeout((()=>{i(null)}),t),e.__uspapi?e.__uspapi("getUSPData",1,((e,t)=>{t?i(e.uspString):s(new Error("Error while trying to get USP data "+JSON.stringify(e)))})):(Math.random()>.9&&ce.Z.error("Tried to get USP data but __uspapi is undefined"),s(new Error("Tried to get USP data but __uspapi is undefined")))}))}(window);null!==e&&(i.params={us_privacy:e})}catch(a){Math.random()>.9&&ce.Z.error("Ads: Error trying to get USP string",a)}window.apstag.init(i,n)}},fetchBids(e,t,i,s){return new Promise(((t,n)=>{const r=s?this.timeoutMs+4e3:this.timeoutMs,d=setTimeout((()=>{t([])}),r),o=Ee()(window.apstag,"Should have the apstag library to fetch bids"),l=e.filter((e=>{var t,i;return(null!=(t=null==(i=e.disabledBidders)?void 0:i.indexOf(me))?t:-1)<0})).filter((e=>e.sizes.length||e.shouldRequestOutstreamBids)).map((e=>{const t=e.sizes.filter((e=>"fluid"!==e)),[i,s]=(0,a.EQ)(),n=k(e.name,{height:s,width:i});if(e.shouldRequestOutstreamBids&&n){const i=(0,a.tI)(n.name);return fe[i]=e.adUnitCode,{mediaType:"multi-format",multiFormatProperties:{display:{sizes:t},video:{sizes:[n.adSize]}},slotID:i,slotName:n.name}}const r=e.adUnitCode;return{sizes:t,slotID:r,slotName:e.name}}));if(l.length<1)return void t([]);const g=window.performance.now();o.fetchBids({slots:l,timeout:r-50},(s=>{const a=window.performance.now(),r=s.filter((t=>{var s;const n=fe[t.slotID]||t.slotID,r=e.filter((e=>e.adUnitCode===n));if(1===r.length){const e=r[0];null==i||i.setLastA9ResponseTime(e.divID,a-g)}const d=t.targeting||{amzniid:""},o=d.amzniid||d.amzniid_sp||d.r_amzniid;return(null!=(s=null==o?void 0:o.length)?s:0)>0})).map((t=>{const i=fe[t.slotID]||t.slotID,s=e.filter((e=>e.adUnitCode===i));1!==s.length&&(clearTimeout(d),n(new Error("a9Bidder::fetchBids: None or more than 1 config matching response")));const a=s[0];return{adsSizes:a.sizes,bidder:me,lastFetchedTimestamp:(0,_e.Z)(),name:a.name,targeting:t.targeting}}));clearTimeout(d),r.forEach((e=>{null==i||i.logAmazonBid(e)})),t(r)}))}))},applyBid:(e,t)=>{Object.keys(t.targeting).forEach((i=>{if(i.includes("amzn")){const s=t.targeting[i];e.setTargeting(i,s)}}))}},Te=Ae,Se=(e,t,i)=>{e.owpbjs?((e,t,i)=>{e.owpbjs&&(t&&e.owpbjs.setConfig({consentManagement:{gdpr:{cmpApi:"static",consentData:{getTCData:{gdprApplies:!1}}},usp:{cmpApi:"iab",timeout:500}}}),i&&e.owpbjs.setConfig({consentManagement:{gdpr:{allowAuctionWithoutConsent:!0,cmpApi:"iab",timeout:500},usp:{cmpApi:"static",consentData:{getUSPData:{uspString:"1---"}}}}}),i||t||e.owpbjs.setConfig({consentManagement:{gdpr:{cmpApi:"static",consentData:{getTCData:{gdprApplies:!1}}},usp:{cmpApi:"static",consentData:{getUSPData:{uspString:"1---"}}}}}))})(e,t,i):((e,t,i)=>{if(!e.PWT)return;const s=e.PWT.HookForPrebidSetConfig;e.PWT.HookForPrebidSetConfig=e=>{var n,a;s&&"function"==typeof s&&s(e),t&&e.consentManagement&&(e.consentManagement.gdpr={cmpApi:"static",consentData:{getTCData:{gdprApplies:!1}}}),i&&null!=(n=e.consentManagement)&&n.usp&&(null==(a=e.consentManagement)||delete a.usp),i||t||!e.consentManagement||delete e.consentManagement}})(e,t,i)},ve=ue.PWT,Re={name:ve,timeoutMs:1300,init(e,t,i,s){var n,r,d,o,l,g,h;if(!window.PWT){const e=[];window.PWT={addKeyValuePairsToGPTSlots(){},generateConfForGPT(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return e.push(["g",i]),[]},jsLoaded(){},removeKeyValuePairsFromGPTSlots(){},requestBids(){},bidMap:{}}}r=window.PWT,d=t,o=e=>(0,a.RK)(i._winningBids,e,H.HS.PreAuction),l=!0,g=e.flooringPredictionVariant,h=$(null==(n=e.browserData)?void 0:n.countryCode),void 0===l&&(l=!1),((e,t,i)=>{const s=t?null:e.HookForPrebidRequestBids;e.HookForPrebidRequestBids=e=>{s&&s(e),i(e)}})(r,l,(e=>{const t="function"==typeof d?d():d;var i;t.partners.openWrap.enabled&&ae(t.floors,t.staticMultiplier,null!=(i=t.partners.openWrap.mult)?i:1,o,e,g,h)})),he(window.PWT,e,s),ge(window.PWT,t,e.shouldLogOWReceivedBids||!1,i)},fetchBids(e,t,i,s){return new Promise(((n,a)=>{Se(window,t.ccpaApplies,t.gdprApplies);const d=s?this.timeoutMs+4e3:this.timeoutMs,o=setTimeout((()=>{n([])}),d),l=Ee()(window.PWT,"Should have the PWT library to fetch bids");e.forEach((e=>{var t;t=e.name,re[t]=new Set}));const g=e.filter((e=>{var t,i;return(null!=(t=null==(i=e.disabledBidders)?void 0:i.indexOf(ve))?t:-1)<0})).map((e=>{const t=e.sizes.filter((e=>"fluid"!==e));e.shouldRequestOutstreamBids&&t.sort(((e,t)=>t[0]===e[0]?t[1]-e[1]:t[0]-e[0]));return{adUnitId:e.adUnitCode,adUnitIndex:e.index,code:e.divID,divId:e.divID,mediaTypes:{banner:{sizes:t}},sizes:t}}));if(g.length<1)return void n([]);const h=window.performance.now();l.requestBids(g,(t=>{const s=window.performance.now(),d=t.filter((e=>{var t;return null==i||i.setLastPwtResponseTime(e.divId,s-h),Object.keys(null==(t=e.bidData)?void 0:t.kvp).length>0})).map((t=>{var i;const s=t.adUnitId,n=e.filter((e=>e.adUnitCode===s));1!==n.length&&(clearTimeout(o),a(new Error("pwtBidder::fetchBids: None or more than 1 config matching response")));const d=n[0],l=d.name,g=null==(i=t.bidData.wb)?void 0:i.adHtml,h=t.bidData.kvp;return g&&((e,t)=>{var i;return(null==re||null==(i=re[e])?void 0:i.has(t))||!1})(l,g)&&(h[r.FRIENDLY_IFRAME]="1"),{adsSizes:d.sizes,bidder:ve,lastFetchedTimestamp:(0,_e.Z)(),name:l,targeting:h}}));clearTimeout(o),n(d)}))}))},applyBid:(e,t)=>{Object.keys(t.targeting).forEach((i=>{if(i.includes("pwt")||i.includes("fifr")){const s=t.targeting[i];e.setTargeting(i,s)}}))}},be=Re;var Pe=i("./app/j/config/constants.ts"),ye=i("./app/j/utils/isAdBlockerEnabled.ts"),Oe=i("./app/j/utils/sampleAt.ts"),De=i("./node_modules/uuid/dist/esm-browser/v4.js");class we{constructor(e){this.QMeasure=e,this._bidders={},this._bids={},this._expiredBids=new Set}static getCurrentAid(e){return we._eleIdToCurrentAid[e]||null}setup(e,t,i,s,n){this._adEventLogger=i,this._bidders={},this._bidManagerConfig=s,!s.disableA9&&s.a9PubId&&s.a9Timeout&&(Te.init(s.a9PubId,s.a9Timeout,s.didPhpAdsRender,e.ccpaApplies&&"experiment"===this.QMeasure.getVariationAndEnroll("SendUSPDataToAps[default,ads]"),n),this._bidders[Te.name]=Te),s.disablePWT||(be.init(e,t,i,this.QMeasure),this._bidders[be.name]=be),this._waitingBidsMap=new Map}async fetchAllBids(e,t,i){const s=[],[n,r]=(0,a.EQ)(),d=[];Object.entries(e).forEach(((e,t)=>{let[i,o]=e;d.push(i),this.initWaitCallback(i);const l={name:i,adUnitCode:"/"+Pe.HW+"/"+i,index:""+t,divID:(0,a.tI)(i),sizes:B(i,o,{height:r,width:n})[0][1],shouldRequestOutstreamBids:o.isOutstream||!1};we._eleIdToCurrentAid[(0,a.tI)(i)]=(0,De.Z)();const g=[];o.useHeaderBidding||g.push(ue.A9),o.usePWTBidding||g.push(ue.PWT),g.length&&(l.disabledBidders=g),s.push(l)}));const o=[];for(const a of Object.values(this._bidders)){var l,g;s.forEach((e=>{const t=e.sizes.map((e=>2===e.length?e[0]+"x"+e[1]:"fluid"===e?"fluid":""));this.log("Fetching "+a.name+" bids for "+e.name,{sizes:t,isEarlyRequest:i})})),o.push(a.fetchBids(s,{ccpaApplies:(null==(l=this._bidManagerConfig)?void 0:l.ccpaApplies)||!1,gdprApplies:(null==(g=this._bidManagerConfig)?void 0:g.gdprApplies)||!1},this._adEventLogger,i))}await Promise.all(o).then((e=>{for(const i of e.flat()){var t;if(!i)continue;const e=i.name;e in this._bids||(this._bids[e]=[]),null==(t=this._bids[e])||t.push(i)}})),this.runWaitCallbacks(d),t&&t()}async applyPrefetchedBidsToSlots(e,t,i,s){const n=[];Object.entries(e).forEach((e=>{let[t,[a,r]]=e;n.push(this.applyPrefetchedBidsToSlot(t,a,r,i,s))})),await Promise.all(n).then(t)}async applyPrefetchedBidsToSlot(e,t,i,s,n){return new Promise((a=>{const r=setTimeout((()=>{a(e)}),1500);if(this.cleanupSlotAndExpiredBids(e,t,n),this._waitingBidsMap.has(e)){const n=()=>this.applyStoredBidsToSlot(e,t,i,s).then((e=>{a(e),r&&clearTimeout(r)}));this.addWaitCallback(e,n)}else this.applyStoredBidsToSlot(e,t,i,s).then((e=>{a(e),r&&clearTimeout(r)}))}))}async applyStoredBidsToSlot(e,t,i,s){for(this._expiredBids.has(e)&&s&&(await this.fetchAllBids({[e]:i}),this._expiredBids.delete(e));this.hasStoredBids(e);){var n;const i=null==(n=this._bids[e])?void 0:n.pop();if(!i)break;const s=this._bidders[i.bidder];this.log("Applying "+i.bidder+" bids for "+i.name,i.targeting);try{null==s||s.applyBid(t,i)}catch(a){(0,Oe.Z)(.01,(()=>{var e;return ce.Z.error("Probable undefined slot when applying bid",a,{abTestGptSlotManagementVariant:null!=(e=this.QMeasure.getFeatureFlagOrTestVariantWithoutEnrolling("GptSlotManagement[default,ads]"))?e:"not enrolled"})}))}}return this.flushAdsBids([e]),e}cleanupSlotAndExpiredBids(e,t,i){try{t.getTargetingKeys().forEach((e=>{(e.startsWith("amzn")||e.startsWith("pwt"))&&t.clearTargeting(e)})),this.flushExpiredAdsBids([e])}catch(s){(0,Oe.Z)(.01,(()=>{var n,a,r;return ce.Z.error("(1%) Ads: Undefined gpt slot encountered during KV cleanup",s,{adBlock:(0,ye.ZP)(!1),adLogs:(0,j.co)(200,["Flooring"]),adName:e,abTestGptSlotManagementVariant:null!=(n=this.QMeasure.getFeatureFlagOrTestVariantWithoutEnrolling("GptSlotManagement[default,ads]"))?n:"not enrolled",isPubAdsReady:googletag.pubadsReady||null,isGoogletagApiReady:googletag.apiReady,isValidAdSlot:!!Object.keys(t||{}).length,adsDisabledReasons:null==i?void 0:i.adsDisabledReasons,gptSlotData:(null==googletag.pubads||null==(a=(r=googletag.pubads()).getSlots)?void 0:a.call(r).map((e=>e.getAdUnitPath())))||null})}))}}initWaitCallback(e){this._waitingBidsMap.has(e)||this._waitingBidsMap.set(e,null)}addWaitCallback(e,t){this._waitingBidsMap.has(e)&&this._waitingBidsMap.set(e,t)}runWaitCallbacks(e){for(const i of e){var t;if(this._waitingBidsMap.has(i))null==(t=this._waitingBidsMap.get(i))||t(),this._waitingBidsMap.delete(i)}}flushAdsBids(e){e?e.forEach((e=>{this._bids[e]&&delete this._bids[e]})):this._bids={}}flushExpiredAdsBids(e){const t=(0,_e.Z)();(e||Object.keys(this._bids)).forEach((e=>{const i=this._bids[e];if(!i)return;const s=i.filter((e=>e.lastFetchedTimestamp+3e4>t));s.length?this._bids[e]=s:(delete this._bids[e],this._expiredBids.add(e))}))}hasStoredBids(e){var t,i;return!(null==(t=null==(i=this._bids[e])?void 0:i.length)||!t)}log(e,t){(0,j.Xq)(e,"BidManager",t)}}we._eleIdToCurrentAid={};var Me=i("./app/j/ads/constants/adConstants.ts");let Ce;!function(e){e.UNKNOWN_REASON="{unknown}",e.ABOUT_PAGE="about_page",e.ADS_HOLD_OUT="ads_hold_out",e.AUTOMATED_TEST="automated_test",e.DISABLED_QUERY_PARAM_ADDED="disabled_query_param_added",e.EMBEDDED="embedded",e.ERROR_PAGE="error_page",e.EXPLANATIONS="explanations",e.EXPLANATIONS_PREMIUM_CONTENT="explanations_premium_content",e.GOODBYE_PAGE="goodbye_page",e.HELP_PAGE="help_page",e.HOMEPAGE="logged_out_homepage",e.INFO_PAGE="info_page",e.INTL_LCP_AB_TEST="int_lcp_ab_test",e.IN_TEACHER_CLASS="in_teacher_class",e.INTERNAL_PAGE="internal_page",e.INVOICE_PAGE="invoice_page",e.IS_UNDERAGE="is_underage",e.LIVE_PAGE="live_page",e.LOGIN_PAGE="login_page",e.PAID_TEACHER="is_paid_teacher",e.STUDY_PATH_PAGE="STUDY_PATH_PAGE",e.PRINT_PAGE="print_page",e.PROMO_PAGE="promo_page",e.RVA_REWARD_30_MINS_AD_FREE="rva_reward_30_mins_ad_free",e.SIGNUP_PAGE="signup_page",e.STATS_PAGE="stats_page",e.TEACHER_CLASS="teacher_created_class",e.TESTIMONIALS_PAGE="testimonials_page",e.UPGRADE_PROCESS="upgrade_process",e.UPGRADED_USER="upgraded_user",e.URL_CONTAINS_PII="url_contains_pii",e.VERIFIED_CONTENT="verified_content"}(Ce||(Ce={}));var Ie=i("./app/j/ads/enums/RefreshReason.ts"),Le=i("./node_modules/lodash/pick.js"),xe=i.n(Le),Be=i("./app/j/utils/viewport.ts");class Ne{constructor(e,t){this._slots={},this._outOfPageSlots={},this.config=t,this.googletag=e}resetConfig(e){this.config=e}getAdUnitPathForAdName(e,t){return"/"+e+"/"+t}defineOutOfPageSlot(e){this._outOfPageSlots[e]={},this.googletag.cmd.push((()=>{const t="/"+Pe.ZP.NETWORK_CODE+"/"+e;this.log("Defining OOP slot "+t),this._outOfPageSlots[e]=this.googletag.defineOutOfPageSlot(t,(0,a.tI)(e)).setCollapseEmptyDiv(!0).addService(this.googletag.pubads())}))}defineSlotsForOutOfPageAds(e){void 0===e&&(e=[]),e.forEach((e=>this.defineOutOfPageSlot(e)))}defineSlot(e,t){this._slots[e]={},this.googletag.cmd.push((()=>{const i="/"+Pe.ZP.NETWORK_CODE+"/"+e,s=(0,a.tI)(e),n=function(e){const t=S[e];return f()(t,"Size map should be available"),t}(t.type);try{this.log("Defining GPT slot "+i,{defaultSize:n,containerId:s}),this._slots[e]=this.googletag.defineSlot(i,n,s)}catch(g){Math.random()<=.01&&ce.Z.warn("Ads: Define slot failed",g,{slotName:i,defaultSize:n,containerId:s})}const r=this._slots[e],d=(0,Be.getHeight)(),o=(0,Be.getWidth)();if(!r)return void ce.Z.warn("Ads: Missing slot after define slot",{slotName:i,defaultSize:n,containerId:s});const l=B(e,t,{height:d,width:o});try{const e=l.reduce(((e,t)=>{let[i,s]=t;return{...e,[i[0]+"x"+i[1]]:s.map((e=>2===e.length?e[0]+"x"+e[1]:"fluid"===e?"fluid":""))}}),{});this.log("Adding size mapping for GPT slot "+i,{pageHeight:d,pageWidth:o,sizeMapping:e}),r.defineSizeMapping(l)}catch(g){ce.Z.warn("Ads: Define size mapping failed",g,{slotName:i,defaultSize:n,containerId:s,sizeMapping:l,pageHeight:d,pageWidth:o})}r.setCollapseEmptyDiv(!0).addService(this.googletag.pubads())}))}defineSlotsForRegisteredAds(e){Object.keys(e).filter((t=>{const i=e[t];if(f()(i,"Ad should have been registered"),i.type===p.D.VIDEO||!0===i.lazyLoaded)return!1;if(!i.defineSlotImmediately)return!1;const[s]=B(t,i,{height:(0,Be.getHeight)(),width:(0,Be.getWidth)()});return!(s.length>=2&&0===s[1].length)})).forEach((t=>{const i=e[t];f()(i,"Ad '"+t+"' should have been registered"),this.defineSlot(t,i)}))}clearSlot(e){this.googletag.cmd.push((()=>{const t=this._slots[e];t&&(this.log("Clearing GPT slot "+e),this.googletag.pubads().clear([t]))}))}isOutOfPageSlotCreated(e){return!!this._outOfPageSlots[e]}refreshGPTAdSlots(e,t,i){this.googletag.cmd.push((()=>{const s=t(e);try{this.log("Refreshing GPT slots "+e),this.googletag.pubads().refresh(s);const t=s.map((e=>e.getSlotElementId()));new Set(t).size!==t.length&&Math.random()<=.01&&ce.Z.warn("Ads: Refreshing duplicate slots",{argument:e,refreshed:t}),i.markGPTRequestSent(t)}catch(n){const e=this.googletag.pubadsReady?"Ads: Ad refresh command failed":"Ads: Ad tried to refresh before pubadsReady";Math.random()<=.01&&ce.Z.warn(e,{errorMessage:n.message,keyValues:this.config.keyValues,googletagProperties:Object.keys(this.googletag)})}}))}destroySlot(e,t){this.googletag.cmd.push((()=>{try{const i=this._slots[e];i&&(this.log("Destroying GPT slot "+e),this.googletag.destroySlots([i]),t(e),delete this._slots[e])}catch(i){Math.random()<=.001&&ce.Z.warn("Ads (0.1%): Failed to destroy ad slot",i,e)}}))}destroyAllSlots(){Object.keys(this._slots).forEach((e=>this.destroySlot(e,(()=>{}))))}destroyOOPSlots(){this.googletag.cmd.push((()=>{this.googletag.destroySlots(Object.values(this._outOfPageSlots)),this._outOfPageSlots={}}))}log(e,t){(0,j.Xq)(e,"GPTAdSlots",t)}}const ke=()=>{const e={};if("undefined"!=typeof window){var t;const i=(null==(t=window.navigator)?void 0:t.connection)||{};(i.downlink||0===i.downlink)&&(e.dl=String(i.downlink)),(i.rtt||0===i.rtt)&&(e.rtt=String(i.rtt))}return e};var Ve=i("./node_modules/matchmedia/index.js"),We=i.n(Ve),He=i("./app/j/utils/LocalStorageHelper.ts");class je{constructor(e,t,i,s,n){this._resizeListeners=new Map,this._gptRan=!1,this._hasMarkedPageDepth=!1,this.shouldRenderOutOfPageSlots=()=>this.getOutOfPageAdsSlotNames().length>0,this.persistentKVs=[r.OW_SCREEN_HEIGHT,r.OW_SCREEN_WIDTH,r.IS_TEACHER,r.GRADE_LEVELS],this.displayOutOfPageAd=e=>{setTimeout((()=>{this.googletag.cmd.push((()=>{if(this.adSlots._outOfPageSlots[e])try{this.log("Displaying OOP ad "+e),this.googletag.display(this.adSlots._outOfPageSlots[e]),this.refreshOutOfPageAd(e)}catch(t){Math.random()<=.01&&ce.Z.warn("Ads: Error displaying out of page ad",t)}else ce.Z.warn('Ads: Tried to display out of page ad for non-existent ad slot "'+e+'"')}))}),5e3)},this.refreshOutOfPageAd=e=>{this.googletag.cmd.push((()=>{try{this.log("Refreshing OOP ad "+e),this.googletag.pubads().refresh([this.adSlots._outOfPageSlots[e]])}catch(t){Math.random()<=.01&&ce.Z.warn("Ads: Out of page ad refresh command failed",{errorMessage:t.message,keyValues:this.config.keyValues,googletagProperties:Object.keys(this.googletag)})}}))},this.slotManagementVariant=n,this.config=t,this.googletag=e,this.adSlots=new Ne(this.googletag,this.config),this._eventHandler=i,this.logAdsEvent=s}resetConfig(e){this.config=e,this.adSlots.resetConfig(e)}getUSPConsentState(){const e=this.config.keyValues.ot;return"string"==typeof e&&Object.values(H.Kl).indexOf(e)>=0?e:H.Kl.Unknown}addUSPConsent(){const e=this.getUSPConsentState();e!==H.Kl.ApplicableWaitingForConsent&&e!==H.Kl.ApplicableConsentGiven||(this.log("Not restricting GPT data processing"),this.googletag.pubads().setPrivacySettings({restrictDataProcessing:!1})),e===H.Kl.ApplicableConsentNotGiven&&(this.log("Restricting GPT data processing"),this.googletag.pubads().setPrivacySettings({restrictDataProcessing:!0}))}setOnSlotRenderEndedCallback(e){this.googletag.cmd.push((()=>{googletag.pubads().addEventListener("slotRenderEnded",(t=>{e(t)}))}))}runInGPTQueue(e){this.googletag.cmd.push((()=>{e()}))}collapseAdContainer(e){return()=>{const t=document.getElementById(e);t&&(t.style.display="none")}}registerCallbackForPHPRenderedAds(e,t){Object.keys(e.registeredAds).forEach((i=>{const s=e.registeredAds[i];null!=s&&s.isPHPRendered&&t(i,this.collapseAdContainer(i))}))}addKVToSlot(e,t,i){this.isShowing(e)&&this.googletag.cmd.push((()=>{var s;null==(s=this.getAdSlot(e))||s.setTargeting(t,i)}))}getAdSlot(e){return this.adSlots._slots[e]}getAdSlotKeys(){return Object.keys(this.adSlots._slots)}isShowing(e){return!!this.getAdSlot(e)}getOutOfPageAdSlotKeys(){return Object.keys(this.adSlots._outOfPageSlots)}getOutOfPageAdsSlotNames(){var e;return null!=(e=this.config.outOfPageSlotNames)?e:[]}setTargeting(){this.log("Setting global-level targeting",this.config.keyValues);for(const[t,i]of Object.entries(this.config.keyValues))this.googletag.pubads().setTargeting(t,i);const e=ke();for(const[t,i]of Object.entries(e))this.googletag.pubads().setTargeting(t,i)}addKV(e,t){this.googletag.cmd.push((()=>{this.addKeyValueToConfigObject(e,t),this.setTargeting()}))}addKeyValueToConfigObject(e,t){this.config.keyValues[e]=t}removeKeyValueFromConfigObject(){Object.keys(this.config.keyValues).includes(r.PAGE_DEPTH)&&delete this.config.keyValues[r.PAGE_DEPTH],this.googletag.pubadsReady&&this.googletag.pubads().clearTargeting(r.PAGE_DEPTH)}resetKVs(e){const t=xe()(this.config.keyValues,this.persistentKVs);this.googletag.cmd.push((()=>{this.googletag.pubads().clearTargeting(),this.config.keyValues={...t,...e},this.setTargeting()}))}setPageDepthTargeting(e){this.addKeyValueToConfigObject(r.PAGE_DEPTH,e),this.googletag.pubadsReady&&this.googletag.pubads().setTargeting(r.PAGE_DEPTH,e)}loadGPTLibrary(){this._gptRan||(this._gptRan=!0,(0,a.LN)("https://securepubads.g.doubleclick.net/tag/js/gpt.js"))}isRegistered(e){return!!this.config.registeredAds[e]}getResizeListenerForSize(e){const[t,i]=e,s=t+"x"+i;if(!this._resizeListeners.has(s)){const e=this.getMatchMedia("(min-width: "+t+"px) and (min-height: "+i+"px)");e.addListener(this._eventHandler),this._resizeListeners.set(s,{mediaQuery:e,adsToRefresh:new Set})}return this._resizeListeners.get(s)}addResizeListenersForAd(e){const t=this.config.registeredAds[e];(x(e,t)||[]).forEach((t=>{const i=t[0],s=this.getResizeListenerForSize(i);s&&s.adsToRefresh.add(e)}))}removeResizeListenerForAd(e){if(this.isRegistered(e)&&this.isShowing(e))for(const t of this._resizeListeners.values())t.adsToRefresh.delete(e)}checkRegisterAndDefineSlot(e){var t;if(!this.isRegistered(e))return void ce.Z.warn('Ads: Tried to display ad for non-existent ad slot "'+e+'"');const i=this.config.registeredAds[e];f()(i,"Ad should have been registered");("experiment"===this.slotManagementVariant?!(null!=(t=this.getAdSlot(e))&&t.setTargeting):!this.isShowing(e))&&this.adSlots.defineSlot(e,i)}displayAd(e,t,i){void 0===i&&(i=!1),this.checkRegisterAndDefineSlot(e),this.setPageDepthKeyValue(i),this.addResizeListenersForAd(e),this.googletag.cmd.push((()=>{const i=(0,a.tI)(e);if(document.getElementById(i))try{this.log("Displaying ad "+e),this.googletag.display(i),t()}catch(s){ce.Z.warn("Ads: Ad display command failed",s)}else!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];ce.Z.warn("(1%) "+e,...i)}("Ads: Ad container with id "+i+" does not exist on page")}))}setPageDepthKeyValue(e){if(void 0===e&&(e=!1),this._hasMarkedPageDepth)return;if(this._hasMarkedPageDepth=!0,e)return;let t=0;const i=new He.Z,s=i.getItem(Me.Vj);null!==s&&(t=+s),t++,i.setItem(Me.Vj,t.toString()),t<=3?this.setPageDepthTargeting(t.toString()):this.removeKeyValueFromConfigObject()}destroyPHPDefinedSlot(e){this.googletag.cmd.push((()=>{const t=[];if(this.isShowing(e)){const i=this.getAdSlot(e);i&&t.push(i)}t.length>0&&(this.log("Destroying GPT slot "+e),this.googletag.destroySlots(t))}))}destroyAllPHPSlots(){this.googletag.cmd.push((()=>{let e=[];e=this.googletag.pubads().getSlots().filter((e=>e.getSlotElementId().startsWith("php-"))),e.length>0&&(this.log("Destroying GPT slots "+e.map((e=>e.getSlotElementId()))),this.googletag.destroySlots(e))}))}destroySlot(e){this.adSlots.destroySlot(e,(e=>{this.removeResizeListenerForAd(e)}))}resetSlots(e,t){this._resizeListeners.clear(),this.adSlots.destroyAllSlots(),this.adSlots.destroyOOPSlots(),this.adSlots.defineSlotsForOutOfPageAds(t),this.adSlots.defineSlotsForRegisteredAds(e)}resetPageDepthMark(){this._hasMarkedPageDepth=!1}getMatchMedia(e){return We()(e)}initGPT(e,t){this.googletag.cmd.push((()=>{this.googletag.pubads().setPrivacySettings({childDirectedTreatment:this.config.tagForChildDirectedTreatment}),this.addUSPConsent(),e(),this.setTargeting()})),this.adSlots.defineSlotsForOutOfPageAds(this.config.outOfPageSlotNames),this.adSlots.defineSlotsForRegisteredAds(this.config.registeredAds),this.registerCallbackForPHPRenderedAds(this.config,t),this.googletag.cmd.push((()=>{try{this.googletag.pubads().disableInitialLoad(),this.googletag.enableServices()}catch(e){Math.random()<=.01&&ce.Z.warn("Ads: Error with initialization",e)}}))}log(e,t){(0,j.Xq)(e,"GPTManager",t)}}var Ge=i("./app/j/ads/utils/AdEventEmitter.ts"),Fe=i("./app/j/ads/utils/adsDebugToolUtils.ts");const Ue=(0,i("./app/j/hocs/lazilyLoadComponent.tsx").Z)((()=>i.e("ads_debug_tool_lazy").then(i.bind(i,"./app/j/ads/components/debug_tool/AdsDebugTool.tsx"))));var ze=i("./node_modules/react/jsx-runtime.js");const Ze=e=>{},Ke=()=>new Promise((e=>{null==window.__tcfapi||window.__tcfapi(H.BH.ADD_EVENT_LISTENER,2,(e=>(t,i)=>{i&&t.eventStatus!==H.hn.CPUISSHOWN&&(e(t),null==window.__tcfapi||window.__tcfapi(H.BH.REMOVE_EVENT_LISTENER,2,Ze,t.listenerId))})(e))})),qe=(e,t,i,s,n,a)=>new Promise(((r,d)=>{try{((e,t,i,s,n,a,r,d)=>{Z("Fetching floors with max-age="+F);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(4===o.readyState)if(200===o.status){var l;const d=null!=(l=JSON.parse(o.responseText))?l:{},g=ee(d,e,t,i,s,n,a);Z("Built flooring config",g),r(g)}else 0===o.status?null==d||d(new Error("Fetching ad floors timed out")):null==d||d(new Error("Fetching ad floors failed with statusCode="+o.status))},o.open("GET","https://d3q9h1uwpmml3k.cloudfront.net/floors.json",!0),o.setRequestHeader("Cache-Control","max-age="+F),o.send()})(e,t,i,s,n,a,(e=>{r(e)}),(e=>{d(e)}))}catch(o){d(o)}})),Qe=()=>new Promise(((e,t)=>{try{((e,t)=>{Z("Fetching floors with max-age="+F);const i=new XMLHttpRequest;i.onreadystatechange=()=>{if(4===i.readyState)if(200===i.status){var s;const t=null!=(s=JSON.parse(i.responseText))?s:{};Z("Built flooring config",t),e(t)}else 0===i.status?null==t||t(new Error("Fetching ad floors timed out")):null==t||t(new Error("Fetching ad floors failed with statusCode="+i.status))},i.open("GET","/webapi/3.8/flooring-predictions",!0),i.setRequestHeader("Cache-Control","max-age="+F),i.send()})((t=>{e(t)}),(e=>{t(e)}))}catch(i){t(i)}}));let Xe;!function(e){e.CUSTOM_HARD_UPR="chu",e.PWT_BID_ECPM="pwtecp"}(Xe||(Xe={}));const Ye=[4,3.8,3.6,3.4,3.2,3,2.8,2.6,2.4,2.2,2,1.95,1.9,1.85,1.8,1.75,1.7,1.65,1.6,1.55,1.5,1.45,1.4,1.35,1.3,1.25,1.2,1.15,1.1,1.05,1,.95,.9,.85,.8,.75,.7,.65,.6,.55,.5,.45,.4,.36,.32,.28,.24,.2,.18,.16,.14,.12,.1,.09,.08,.07,.06,.05,.04,.03,.02,.01],Je=e=>{for(let t=0;t<Ye.length;t++){const i=Ye[t];if(e>=i)return i}return Ye[Ye.length-1]},$e=(e,t,i,s,n,a)=>{const r=((e,t)=>{var i,s,n;const a=e.floors.geoc_mult,r=null!=(i=null!=(s=null==a?void 0:a[t])?s:null==a?void 0:a.other)?i:1;return(null!=(n=e.partners.adX.minUSUPRFloor)?n:0)*r})(e,s);if("control"!==n){const n=$(s),r=e.floors[t];let d=n;return r&&(d=r[i]||n),Math.max(Je(d),a&&a>0?Je(a):0)}{if(a&&a>0)return Je(a);const s=J(e.floors,t,"UPR",i,e.staticMultiplier);return Je(Math.max(s,r))}},et=(e,t,i,s,n)=>{if("function"==typeof(null==t?void 0:t.setTargeting)){const a=t.getSlotElementId(),r=((e,t,i,s,n)=>{if("function"==typeof(null==t?void 0:t.getTargeting)&&"function"==typeof(null==t?void 0:t.getSlotElementId)){const a=t.getSlotElementId(),r=t.getTargeting(Xe.PWT_BID_ECPM),d=()=>$e(e,a,i,s,n);if(0===r.length)return d();const o=+r[0];return Number.isNaN(o)?d():$e(e,a,i,s,n,o)}return 0})(e,t,"function"==typeof i?i(a):i,s,n),d=e=>{const t=Y(e),i=String(t);switch(i.length){case 1:return i+".00";case 3:return i+"0";default:return i}};t.setTargeting(Xe.CUSTOM_HARD_UPR,d(r>0?r:.01))}return t};var tt=i("./app/j/i18n/$t.ts"),it=i("./app/j/utils/Cookie.ts"),st=i("./app/j/utils/FetchWith.ts"),nt=i("./app/j/utils/log-event.ts");const at={[H.ky.APSTAG]:!1,[H.ky.GPT]:!1,[H.ky.PWT]:!1},rt=(e,t)=>{const i=(e=>window.performance.getEntriesByType("resource").filter((t=>t.name.includes(e))).map((t=>({name:e.replace(".js",""),duration:Math.round(t.duration),elapsed:Math.round(t.responseEnd),url:window.location.href}))))(e),s={sendSooner:!0,includeAppSessionId:!0,includeUserDetails:!0};i.forEach((e=>(0,nt.K)(t,"ad_script_timing",e,s)))},dt=e=>{at[H.ky.PWT]||(at[H.ky.PWT]=!0,rt(H.ky.PWT,e))},ot="adsDebugMenu",lt="undefined"!=typeof window?window:{};class gt{constructor(e,t,i,s,n){var d;if(this._outOfPageSlots={},this._isAdsDebugPanelOpen=!1,this._adsPerformanceFirstRenderCallback=null,this._eventEmitter=new Ge.Z,this._hasMarkedFirstAdRendered=!1,this._hasMarkedSetRectangleHeaderAdRendered=!1,this.gptSlotStrategyVariant=null,this.adsRefreshCount={},this.lastAdRefreshData={},this._PWTFriendlyIframeCreatives={},this.amazonBidsData=[],this.bidReportStartTime=(new Date).getTime(),this.TAMBiddingTimeout=1300,this.PWTBiddingTimeout=1300,this.GPTFailsafeTimeout=1400,this.onPubmaticRendererLoad=(e,t)=>{this.PWT=e,this.OWT=t,this.config.shouldLogAdScriptsTiming&&dt(this._adEventLogger.config)},this.shouldRenderOutOfPageSlots=()=>this.gptManager.getOutOfPageAdsSlotNames().length>0,this.displayOutOfPageAd=e=>{this.gptManager.displayOutOfPageAd(e)},this.refreshOutOfPageAd=e=>{this.gptManager.refreshOutOfPageAd(e)},this._shouldRefresh=!0,this.getAdSlotContainerSizeFromDOM=e=>{const t=document.getElementById(e);return t?[t.offsetWidth,t.offsetHeight]:null},this.updateAndSetAdRefreshCountKVForAdUnit=e=>{const t=this.gptManager.getAdSlot(e);if(null!=t&&t.setTargeting&&"function"==typeof(null==t?void 0:t.setTargeting)){if(this.adsRefreshCount[e])this.adsRefreshCount[e]++;else{let t=1;!this.shouldPHPRenderAd||e!==c.h.SET_SIDEBAR_V4&&e!==c.h.SET_RECTANGLE_HEADER||(t=2),this.adsRefreshCount[e]=t}const i=this.adsRefreshCount[e];t.setTargeting(r.AD_REFRESH_COUNT,i.toString());const s=(0,a.bN)(i);null!==s&&i<4?t.setTargeting(r.AD_REFRESH_COUNT_BUCKETS,s):4===i&&t.clearTargeting(r.AD_REFRESH_COUNT_BUCKETS)}return t},this.setRequestedWithoutBidsKVForSlots=(e,t,i)=>{if(e.setTargeting&&"function"==typeof e.setTargeting){let s=H.yl.WithBids;t&&i?s=H.yl.WithoutApstagAndPWTBids:t?s=H.yl.WithoutApstagBid:i&&(s=H.yl.WithoutPWTBid),e.setTargeting(r.REQUESTED_WITHOUT_BIDS,s)}return e},this.removeFriendlyIframeTargetingKVFromSlot=e=>(((null==e||null==e.getTargetingKeys?void 0:e.getTargetingKeys())||[]).indexOf(r.FRIENDLY_IFRAME)>-1&&(null==e||null==e.clearTargeting||e.clearTargeting(r.FRIENDLY_IFRAME)),e),this.handleSlotRenderEnded=e=>{const t=e.slot.getSlotElementId(),i=(0,a.e9)(t);(""+i).startsWith("php-")||this.gptManager.getOutOfPageAdSlotKeys().includes(i)||(this.showAdHeadingForNotEmptySlotOrNotQuizletAd(t,e.isEmpty,e.advertiserId,e.campaignId),e.isEmpty?this.callEmptyAdCallback(i):this.callEventCallback(i,Ge.T.AdLoaded,e),this.getAdType(i)===p.D.NATIVE&&null!=e.slot.getHtml&&e.slot.getHtml().includes("native-ad")&&this.callNativeAdCallback(i),this._hasMarkedFirstAdRendered||(this._hasMarkedFirstAdRendered=!0,(0,a.OE)()),this.shouldMarkRectangleHeaderAdRendered(i)&&(this._hasMarkedSetRectangleHeaderAdRendered=!0,(0,a.G2)()))},this.handleSlotRequestLogging=e=>{this.logAdsEvent("ad_slot_requested",(0,a.e9)(e.slot.getSlotElementId()))},this.handleSlotRenderEndedLogging=e=>{var t;this._adsPerformanceFirstRenderCallback&&(this._adsPerformanceFirstRenderCallback(),this._adsPerformanceFirstRenderCallback=null);const i=e.slot.getSlotElementId(),s=e.size,n=this.getAdSlotContainerSizeFromDOM(i),r=null!=(t=null==e.slot.getContentUrl?void 0:e.slot.getContentUrl())?t:"";this.logAdsEvent("ad_slot_rendered",(0,a.e9)(i),{advertiserId:e.advertiserId,containerSize:n,isEmpty:e.isEmpty,isRenderingDifferentSize:JSON.stringify(s)!==JSON.stringify(n),size:s,...r&&{requestLength:r.length,isRequestOver2kChars:r.length>=2e3}})},this.handleImpressionViewableLogging=e=>{this.logAdsEvent("ad_slot_impression_viewable",(0,a.e9)(e.slot.getSlotElementId()))},this.onAdViewableEvent=e=>{if(!e||!e.ele_id)return;const t=e.ele_id.replace(/dfp-|php-/,"");this.callEventCallback(t,Ge.T.AdIsViewable,e)},this.onWinningEvent=e=>{if(!e||!e.ele_id)return;const t=e.ele_id.replace(/dfp-|php-/,"");this.callWinningEventCallback(t,e)},this.getWidthAndHeightFromMediaQueryEvent=e=>{const t=/min-width:\s*(\d+)px/g.exec(e.media),i=parseInt(u()(o()(t,1),""),10),s=/min-height:\s*(\d+)px/g.exec(e.media),n=parseInt(u()(o()(s,1),""),10);return Number.isNaN(n)||Number.isNaN(i)?(ce.Z.warn("Ads: Failed to parse resize media query change."),null):[i,n]},this._handleMediaQueryChange=e=>{const t=this.getWidthAndHeightFromMediaQueryEvent(e);if(!t)return;const[i,s]=(0,a.EQ)(),[n,r]=t,d=this.gptManager.getResizeListenerForSize([n,r]);if(d){const e=[];if(d.adsToRefresh.forEach((t=>{const n=this.config.registeredAds[t];if(!n)return;B(t,n,{height:s,width:i}).some((e=>{let[,t]=e;return t.length>0}))&&(e.push(t),this.gptManager.adSlots.clearSlot(t),this.updateSlotSizeMapping(t),this.gptManager.isShowing(t)||this.gptManager.adSlots.defineSlot(t,n))})),e.length>0){const t=e.map(a.tI);this._adEventLogger.resetAuctionIds(t),this.enqueueAdsForRefresh(e,Ie.q.RESIZE_REFRESH)}}},this.shouldMarkRectangleHeaderAdRendered=e=>!this.shouldPHPRenderAd&&!this._hasMarkedSetRectangleHeaderAdRendered&&e===c.h.SET_RECTANGLE_HEADER&&this.isRegistered(c.h.SET_RECTANGLE_HEADER),this.config=t,this.config.shouldLogAdRequests=!0,this.googletag=e,this.QMeasure=i,this.shouldWaitForConsent=t.gdprApplies,t.gdprApplies&&(window.__tcfapi?(this.log("__TcfApi availble. Fetching user consent status"),this.getUserConsentStatus()):(this.log("__TcfApi unavailible waiting 1 sec to try again"),setTimeout((()=>{window.__tcfapi?(this.log("__TcfApi availble fetching user consent status"),this.getUserConsentStatus()):(this.log("__TcfApi unavailible after 1 sec timeout"),ce.Z.warn("__TcfApi unavailible after 1 sec timeout"))}),1e3))),this.logAdsEvent=n,this._adEventLogger=s,this._adEventLogger.addLogMetadata({browserData:t.browserData,deviceCategory:t.deviceCategory,keyValues:t.keyValues,userId:null==(d=t.user)?void 0:d.id}),this._adEventLogger.addOnAdViewableCallback(this.onAdViewableEvent),this._adEventLogger.addOnWinningEventCallback(this.onWinningEvent),this._adEventLogger.addOnWinningEventCallback((e=>{0})),this.config.shouldLogAdScriptsTiming&&((e,t)=>{e.cmd.push((()=>{at[H.ky.GPT]||(at[H.ky.GPT]=!0,rt(H.ky.GPT,t))}))})(this.googletag,this._adEventLogger.config),(0,a.Yh)(),this.shouldPHPRenderAd="Sets/show"===t.actionString,this.flooringConfig={partners:{adX:{enabled:!1},openWrap:{enabled:!1}},floors:{},staticMultiplier:1},"control"!==this.config.flooringTrainVariant||"control"!==this.config.flooringTestVariantTimeRange){var l,g;const e=new He.Z,i=(null==(l=this.config)||null==(g=l.browserData)?void 0:g.browserName)||"",s=(()=>{const t=e.getItem(Me.Vj)||"0";try{return parseInt(t,10)}catch(i){return 0}})();if(this.flooringConfig=ee(K("upr10cOw1x").floors,t.deviceCategory,i,t.countryCode,s,"upr10cOw1x","control"),"control"!==t.flooringPredictionVariant){const e=this.config.predictedFloors||{};Object.keys(e).length?this.flooringConfig.floors=e:Qe().then((e=>{this.flooringConfig.floors=e.floors})).catch((e=>{Math.random()<=.01&&ce.Z.warn("Ads (1%): Failed to fetch predicted floors for advertisers",e)}))}else qe(t.deviceCategory,i,t.countryCode,s,this.config.flooringTrainVariant||"control",this.config.flooringTestVariantTimeRange||"control").then((e=>{this.flooringConfig=e})).catch((e=>{Math.random()<=.01&&ce.Z.warn("Ads (1%): Failed to fetch floors for advertisers",e)}))}const h=this.hasRegisteredAdsWithHeaderBidding(this.config.registeredAds),E=this.hasRegisteredAdsWithPWTBidding(this.config.registeredAds);(h||E)&&(this.BidManager=new we(this.QMeasure),this.BidManager.setup(this.config,(()=>this.flooringConfig),this._adEventLogger,{a9PubId:"3742",a9Timeout:this.TAMBiddingTimeout,didPhpAdsRender:this.shouldPHPRenderAd,disableA9:!h,disablePWT:!E,ccpaApplies:this.config.ccpaApplies,gdprApplies:this.config.gdprApplies},(()=>{this.config.shouldLogAdScriptsTiming&&(e=>{at[H.ky.APSTAG]||(at[H.ky.APSTAG]=!0,rt(H.ky.APSTAG,e))})(this._adEventLogger.config),this.setupAPSAudience()})),this.prefetchInitialAds()),this.PWT=E?this.setupPWTBiddingLibrary():null,Se(lt,this.config.ccpaApplies,this.config.gdprApplies),((e,t)=>{const i=e=>e?"string"==typeof e?[e]:e:[],s=()=>{e.owpbjs&&e.owpbjs.setBidderConfig({bidders:["rubicon"],config:{ortb2:{site:{ext:{data:{[r.CONTENT_CATEGORY_LEVEL_1]:i(t.keyValues[r.CONTENT_CATEGORY_LEVEL_1]),[r.CONTENT_CATEGORY_LEVEL_2]:i(t.keyValues[r.CONTENT_CATEGORY_LEVEL_2]),[r.CONTENT_CATEGORY_LEVEL_3]:i(t.keyValues[r.CONTENT_CATEGORY_LEVEL_3]),[r.CONTENT_CATEGORY_LEVEL_4]:i(t.keyValues[r.CONTENT_CATEGORY_LEVEL_4]),[r.CONTENT_CATEGORY_LEVEL_5]:i(t.keyValues[r.CONTENT_CATEGORY_LEVEL_5]),[r.CONTENT_CATEGORY_LEVEL_6]:i(t.keyValues[r.CONTENT_CATEGORY_LEVEL_6])}}},user:{ext:{data:{[r.GRADE_LEVELS]:i(t.keyValues[r.GRADE_LEVELS]),[r.AGE]:i(t.keyValues[r.AGE])}}}}}})};e.owpbjs&&s(),e.PWT&&le(e.PWT,oe.PREBID_SET_CONFIG,s)})(lt,this.config),this.config.shouldLogAdScriptsTiming&&QWait("Quizlet.pubmatic",(()=>{dt(this._adEventLogger.config)})),this.loadBlockthroughLibrary(),E&&!this.shouldPHPRenderAd&&this.loadAdBiddingLibraries(),this.gptManager=new je(e,t,this._handleMediaQueryChange,this.logAdsEvent,this.gptSlotStrategyVariant||void 0),!h&&!E&&!this.shouldPHPRenderAd&&Object.keys(this.config.registeredAds).length>0&&this.gptManager.loadGPTLibrary()}async waitForGDPRCreateProfilePerm(){if(this.config.gdprApplies){return(await Ke()).purpose.consents[H.X_.CREATE_ADS_PROFILE]}return!0}async setupAPSAudience(){const e=this.config.hashedEmail||"";if(0===e.length||this.shouldPHPRenderAd)return;if("experiment"===this.QMeasure.getVariationAndEnroll("AmazonPublisherAudienceV3[default,ads]")){var t;let i=!1;this.config.gdprApplies&&(i=!(await this.waitForGDPRCreateProfilePerm()));const s={hashedRecords:[{type:"email",record:e}],optOut:i};null==(t=lt.apstag)||null==t.rpa||t.rpa(s),this.log("APS audience configured",s)}}async getUserConsentStatus(){await Ke(),this.shouldWaitForConsent=!1,this.log("User consent status has been retrieved from __TcfApi")}updateForPage(e,t){var i;const s={...e,...t};this.adsRefreshCount={},this.lastAdRefreshData={},this._adEventLogger.resetState({browserData:s.browserData,deviceCategory:s.deviceCategory,keyValues:s.keyValues,userId:null==(i=s.user)?void 0:i.id}),this.gptManager.resetKVs(s.keyValues),this.gptManager.resetSlots(s.registeredAds,s.outOfPageSlotNames),this.config=s,this.gptManager.resetConfig(s),this.prefetchInitialAds()}disableAPSAudience(){var e;null==(e=lt.apstag)||null==e.dpa||e.dpa(),this.log("APS audience disabled")}setupPWTBiddingLibrary(){return lt.PWT||(0,ye.ZP)()||QWait("Quizlet.pubmatic",(()=>{this.PWT=lt.PWT,this.OWT=lt.OWT})),lt.PWT}loadAdBiddingLibraries(){var e,t;lt.PWT&&(e=lt.PWT,t=()=>{QLoad("Quizlet.pubmatic"),this.gptManager.loadGPTLibrary()},le(e,oe.JS_LOADED,t)),this.loadPWTLibrary(),setTimeout((()=>{this.gptManager.loadGPTLibrary()}),3e3)}destroySlot(e){this.gptManager.destroySlot(e)}destroyPHPSlots(){this.gptManager.destroyAllPHPSlots()}loadPWTLibrary(){let e="https://ads.pubmatic.com/AdServer/js/pwt/158861/1887";const t=this.getPWTVersionId();t&&t.length>0&&(e+="/"+t),(0,a.LN)(e+"/pwt.js")}loadBlockthroughLibrary(){(0,a.TL)("https://btloader.com/tag?o=5658125595049984&upapi=true")}getPWTVersionId(){let e=this.config.forcePWTVersionId||"";const t=window.location.href;if(!e&&t.includes("pwtv=")){const i=/pwtv=(.*?)(&|$)/g.exec(t);i&&i.length>=2&&i[1].length>0&&(e=i[1])}return e}init(){this.config.areAdsDisabled||((0,a.Ck)(),this.config.shouldLogAdRequests&&(this._adsPerformanceFirstRenderCallback=(0,a.ZP)(this.logAdsEvent,"first_ad_render_load_time")),this.gptManager.addKeyValueToConfigObject(r.OW_SCREEN_HEIGHT,(0,Be.getHeight)().toString()),this.gptManager.addKeyValueToConfigObject(r.OW_SCREEN_WIDTH,(0,Be.getWidth)().toString()),this.gptManager.initGPT((()=>this.addPubAdsEventListeners()),this.registerOnEmptyAdCallback))}addPubAdsEventListeners(){const e=this.googletag.pubads();e.addEventListener("slotRenderEnded",this.handleSlotRenderEnded),this.config.shouldLogAdRequests&&(e.addEventListener("slotRequested",this.handleSlotRequestLogging),e.addEventListener("slotRenderEnded",this.handleSlotRenderEndedLogging),e.addEventListener("impressionViewable",this.handleImpressionViewableLogging)),this._adEventLogger.setupWinningBidLogging(this.googletag,this.config.shouldLogWinningBids,this.config.shouldLogWinningBidsToBQ),this._adEventLogger.setupClickTracking(!1,!0)}registerCallbackForPHPRenderedAds(){Object.keys(this.config.registeredAds).forEach((e=>{const t=this.config.registeredAds[e];null!=t&&t.isPHPRendered&&this.registerOnEmptyAdCallback(e,this.collapseAdContainer(e))}))}addKV(e,t){this.gptManager.addKV(e,t)}isShowing(e){return this.gptManager.isShowing(e)}getOutOfPageAdsSlotNames(){return this.gptManager.getOutOfPageAdsSlotNames()}resetPageDepthMark(){this.gptManager._hasMarkedPageDepth=!1}disableAdsForRVA30Mins(){if("undefined"==typeof window)return;const e=new Date(1e3*this.config.serverTime+window.performance.now()),t=new Date(+e+18e5),i=(t.getTime()/1e3).toFixed(0);it.ZP.write("rva_reward_30_mins_ad_free",i,{duration:it.p6}),this.log("Disabling ads for 30 mins",{currentServerTime:e,expiryServerTimeMs:t}),this.config.adsDisabledReasons.push(Ce.RVA_REWARD_30_MINS_AD_FREE),this.config.areAdsDisabled=!0,this.gptManager.getAdSlotKeys().forEach((e=>{this.gptManager.destroySlot(e)}))}shouldUseNewSlotDefinitionStrategy(){return null===this.gptSlotStrategyVariant&&(this.gptSlotStrategyVariant=this.QMeasure.getVariationAndEnroll("GptSlotManagement[default,ads]")||""),"experiment"===this.gptSlotStrategyVariant}shouldRenderHardcodedExCo(){return"hardcoded"===this.QMeasure.getVariationAndEnroll("ExCoOnSetPageV1[default,ads]")}shouldRenderHardcodedPrimis(){return"hardcoded"===this.QMeasure.getVariationAndEnroll("PrimisOnSetPageV1[default,ads]")}getValidPrefetchAds(e){return e.filter((e=>this.shouldrefreshWithPrefetch(e)||this.shouldUseNewSlotDefinitionStrategy()||this.gptManager.isShowing(e)))}mapAndValidatePrefetchAds(e){return this.getValidPrefetchAds(e).reduce(((e,t)=>{const i=this.config.registeredAds[t];return i&&(e[t]=i),e}),{})}prefetchBids(e,t,i){if(void 0===e&&(e=this.gptManager.getAdSlotKeys()),this.shouldWaitForConsent)return;if(!this.shouldRefresh)return void this.log("Not prefetching ads because refreshing is disabled",{adsNames:e});let s=this.mapAndValidatePrefetchAds(e);const n=async()=>{var n;("experiment"===this.gptSlotStrategyVariant&&(s=this.mapAndValidatePrefetchAds(e)),this.BidManager)&&(Object.entries(s).forEach((e=>{let[t,i]=e;this.log("Auction triggered for "+t,i)})),null==(n=this.BidManager)||n.fetchAllBids(s,(()=>{null==t||t()}),i))};this.googletag.cmd.push(n)}refreshPrefetchedAds(e,t){void 0===e&&(e=this.gptManager.getAdSlotKeys()),this.shouldUseNewSlotDefinitionStrategy()&&this.getValidPrefetchAds(e).forEach((e=>this.gptManager.checkRegisterAndDefineSlot(e)));const i=this.getValidPrefetchAds(e).reduce(((e,t)=>{const i=this.gptManager.getAdSlot(t),s=this.config.registeredAds[t];return i&&(e[t]=[i,s]),e}),{});Object.keys(i).forEach((e=>{this.log("Applying auction bids for "+e)})),this.googletag.cmd.push((()=>{var e;null==(e=this.BidManager)||e.applyPrefetchedBidsToSlots(i,(e=>this.gptManager.adSlots.refreshGPTAdSlots(e,(e=>this.configureRefresh(e)),this._adEventLogger)),t,this.config)}))}prefetchAndRefreshAds(e){void 0===e&&(e=this.gptManager.getAdSlotKeys()),this.prefetchBids(e,(()=>this.refreshPrefetchedAds(e,!1)))}prefetchInitialAds(){const e=Object.keys(this.config.registeredAds).filter((e=>this.config.registeredAds[e].allowPrefetch&&this.config.registeredAds[e].autoInitialPrefetch));e.length&&(this.log("Prefetching "+e+" because autoInitialPrefetch=true"),this.prefetchBids(e,(()=>{}),!0))}updateSlotSizeMapping(e){if(!this.gptManager.isShowing(e)||!this.isRegistered(e))return;const[t,i]=(0,a.EQ)(),s=B(e,this.config.registeredAds[e],{height:i,width:t}),n=this.gptManager.getAdSlot(e);if(null!=n&&n.defineSizeMapping)if(s.length>0)try{n.defineSizeMapping(s)}catch(r){ce.Z.error("Updating size mapping failed",{adName:e,adConfig:this.config.registeredAds[e],pageHeight:i,pageWidth:t})}else ce.Z.error("No size mapping defined for screen size",{adName:e,adConfig:this.config.registeredAds[e],pageHeight:i,pageWidth:t})}displayAd(e){this.gptManager.displayAd(e,(()=>this.enqueueAdsForRefresh([e],Ie.q.MOUNT_REFRESH)),this.shouldPHPRenderAd)}get shouldRefresh(){return this._shouldRefresh&&!(this._isAdsDebugPanelOpen||this.config.areAdsDisabled)}set shouldRefresh(e){this.log((e?"Enabling":"Disabling")+" ad refreshing"),this._shouldRefresh=e}enqueueAdsForRefresh(e,t){if(void 0===e&&(e=this.gptManager.getAdSlotKeys()),void 0===t&&(t=Ie.q.MOUNT_REFRESH),this.shouldWaitForConsent)return;const i=e.filter((e=>{var t,i;const s=(0,_e.Z)(),n=null!=(t=null==(i=this.lastAdRefreshData[e])?void 0:i.timestamp)?t:0,a=!n||s-n>1e3;return a?this.lastAdRefreshData[e]={...this.lastAdRefreshData[e],timestamp:s}:this.log("ignoring refresh call for "+e+" because last refresh was less than 1s ago"),a}));i.length>0&&(i.forEach((e=>this.gptManager.addKVToSlot(e,r.RESIZE,t===Ie.q.RESIZE_REFRESH?"1":"0"))),this.refreshAds(i,t))}refreshAds(e,t){if(void 0===e&&(e=this.gptManager.getAdSlotKeys()),void 0===t&&(t=Ie.q.MOUNT_REFRESH),!this.shouldRefresh)return void this.log("Not refreshing ads because refreshing is disabled",{adNames:e});const i=Array.from(new Set(e)),{prefetchAds:s=[],adsToPrefetchAndRefresh:n=[],nonRegisteredAds:a=[]}=g()(i,(e=>this.isAutoPrefetched(e)?t===Ie.q.MOUNT_REFRESH||[c.h.SET_SIDEBAR_V4,c.h.SET_RECTANGLE_HEADER].includes(e)?"prefetchAds":"adsToPrefetchAndRefresh":this.shouldrefreshWithPrefetch(e)?"prefetchAds":this.gptManager.isShowing(e)?"adsToPrefetchAndRefresh":this.isRegistered(e)?"_":"nonRegisteredAds"));a.forEach((e=>{ce.Z.warn('Ads: Tried to refresh ad for non-existent ad slot "'+e+'"')})),s.length>0&&this.refreshPrefetchedAds(s,!0),n.length>0&&this.prefetchAndRefreshAds(n)}handleBidFinished(e,t){if(t.hasRequestStarted)return;t.bidProcessFinishedApstag&&t.bidProcessFinishedPWT&&(t.hasRequestStarted=!0,t.failsafeTimeout&&clearTimeout(t.failsafeTimeout),this.gptManager.adSlots.refreshGPTAdSlots(e,(e=>this.configureRefresh(e,t.bidProcessTimeoutApstag,t.bidProcessTimeoutPWT)),this._adEventLogger))}getUPRTargetedSlots(e){return e.map((e=>et(this.flooringConfig,e,(e=>{var t;return(0,a.RK)(null==(t=this._adEventLogger)?void 0:t._winningBids,e,H.HS.PreAuction)}),this.config.countryCode,this.config.flooringPredictionVariant)))}configureRefresh(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);let s=e.map(this.updateAndSetAdRefreshCountKVForAdUnit).filter((e=>void 0!==e)).map((e=>this.setRequestedWithoutBidsKVForSlots(e,t,i)));return this.flooringConfig.partners.adX.enabled&&(s=this.getUPRTargetedSlots(s)),s}saveBidsResponseForDebug(e){var t;null!=(t=this.config.user)&&t.isAdmin&&window.location.search.includes("ads_debug_tool=1")&&(this.amazonBidsData=[...this.amazonBidsData,...e])}getAPSAdsSlots(e){void 0===e&&(e=Object.keys(this.config.registeredAds));const t=e.filter((e=>this.usesHeaderBidding(e)&&this.gptManager.isShowing(e))),[i,s]=(0,a.EQ)();return t.reduce(((e,t)=>{const n=this.gptManager.getAdSlot(t),a=this.config.registeredAds[t];if(n){n.getTargetingKeys().forEach((e=>{e.startsWith("amzn")&&n.clearTargeting(e)}));const[r,d]=B(t,a,{height:s,width:i})[0];if(!d.length)return e;e.push({sizes:d,slotID:n.getSlotElementId(),slotName:n.getAdUnitPath(),slotParams:{}})}return e}),[])}getPWTAdsSlots(e){return void 0===e&&(e=Object.keys(this.config.registeredAds)),e.filter((e=>this.config.registeredAds[e].usePWTBidding&&!!this.gptManager.getAdSlot[e])).map((e=>this.gptManager.getAdSlot[e]))}registerExternalBidders(e){e.length>0&&this.OWT&&this.OWT.registerExternalBidders(e)}notifyExternalBiddingComplete(e){e.length>0&&this.OWT&&this.OWT.notifyExternalBiddingComplete(e)}isOutstream(e){var t;return!(null==(t=this.config.registeredAds[e])||!t.isOutstream)}isRegistered(e){return!!this.config.registeredAds[e]}usesHeaderBidding(e){var t;return!(null==(t=this.config.registeredAds[e])||!t.useHeaderBidding)}usesPWTBidding(e){var t;return!(null==(t=this.config.registeredAds[e])||!t.usePWTBidding)}isLazyLoaded(e){var t;return!(null==(t=this.config.registeredAds[e])||!t.lazyLoaded)}allowsPrefetch(e){var t;return!(null==(t=this.config.registeredAds[e])||!t.allowPrefetch)}isAutoPrefetched(e){var t;return!(null==(t=this.config.registeredAds[e])||!t.autoInitialPrefetch)}shouldrefreshWithPrefetch(e){return this.allowsPrefetch(e)&&(this.usesPWTBidding(e)||this.usesHeaderBidding(e))}getAdType(e){var t;if(this.isRegistered(e))return null==(t=this.config.registeredAds[e])?void 0:t.type;(0,Oe.Z)(.001,(()=>ce.Z.warn('Ads 0.1%: Tried to get ad type for a non-registered ad slot "'+e+'"',{adLogs:(0,j.co)(1e3,["Flooring"])})))}getShowAdHeading(e){var t;return this.isRegistered(e)?!(null==(t=this.config.registeredAds[e])||!t.showAdHeading):((0,Oe.Z)(.001,(()=>ce.Z.warn('Ads 0.1%: Tried to get showAdHeading for a non-registered ad slot "'+e+'"'))),!1)}setPrebidRequestKVs(e){const t=this.config.keyValues[r.GRADE_LEVELS],i=this.config.keyValues[r.IS_TEACHER];(t||i)&&e.forEach((e=>{e.bids=e.bids.map((e=>("appnexus"===e.bidder&&(e.params.keywords=e.params.keywords||{},e.params.keywords[r.GRADE_LEVELS]=t),"onemobile"===e.bidder&&(e.params.ext=e.params.ext||{},e.params.ext[r.IS_TEACHER]=i),e)))}))}showAdHeadingForNotEmptySlotOrNotQuizletAd(e,t,i,s){const n=this.getAdHeadingContainer(e);if(n){const r=(0,a.e9)(e);this.getShowAdHeading(r)&&!t&&4623761902!==i&&2548271416!==s?(n.style.display="flex",this.changeAdHeadingElementsDisplay(n,"inline-flex")):(n.style.display="none",this.changeAdHeadingElementsDisplay(n,"none"))}}changeAdHeadingElementsDisplay(e,t){this.changeChildElementDisplay(e,".AdHeading-removeLink",t),this.changeChildElementDisplay(e,".AdHeading-upgradePrice",t)}changeChildElementDisplay(e,t,i){const s=e.querySelector(t);s&&(s.style.display=i)}hasRegisteredAdsWithHeaderBidding(e){return(Object.values?Object.values(e):Object.getOwnPropertyNames(e).map((t=>e[t]))).some((e=>!0===e.useHeaderBidding))}hasRegisteredAdsWithPWTBidding(e){return(Object.values?Object.values(e):Object.getOwnPropertyNames(e).map((t=>e[t]))).some((e=>!0===e.usePWTBidding))}registerEventCallback(e,t,i){this._eventEmitter.on(e,t,i)}clearEventCallback(e,t){this._eventEmitter.off(e,t)}callEventCallback(e,t,i){this._eventEmitter.emit(e,t,i)}registerOnEmptyAdCallback(e,t){this.registerEventCallback(e,Ge.T.EmptyAdReceived,t)}clearOnEmptyAdCallback(e){this.clearEventCallback(e,Ge.T.EmptyAdReceived)}callEmptyAdCallback(e){this.callEventCallback(e,Ge.T.EmptyAdReceived)}registerOnNativeAdCallback(e,t){this.registerEventCallback(e,Ge.T.NativeAdReceived,t)}clearOnNativeAdCallback(e){this.clearEventCallback(e,Ge.T.NativeAdReceived)}callNativeAdCallback(e){this.callEventCallback(e,Ge.T.NativeAdReceived)}clearOnAdViewableEventCallback(e){this.clearEventCallback(e,Ge.T.AdIsViewable)}registerOnWinningEvent(e,t){this.registerEventCallback(e,Ge.T.WinningEvent,t)}clearOnWinningEventCallback(e){this.clearEventCallback(e,Ge.T.WinningEvent)}callWinningEventCallback(e,t){this.callEventCallback(e,Ge.T.WinningEvent,t)}addResizeListenersForAd(e){this.gptManager.addResizeListenersForAd(e)}getPageAdsDataForReport(){return this.googletag.pubads().getSlots().reduce(((e,t)=>{const i=t.getSlotElementId();if(e[i])return e;const s=this.getAdResponse(t),n=this.getTargetingKeys(t),a={...this.getWinningBidDataForReport(i),...this.getDfpQueryId(i),...s,kvInfo:{}};if(n.length>0){const e=n.reduce(((e,i)=>(e[i]=this.getTargeting(t,i),e)),{});a.kvInfo=e}return e[i]=a,e}),{})}getAdResponse(e){return null==e.getResponseInformation?void 0:e.getResponseInformation()}getTargetingKeys(e){return null==e.getTargetingKeys?void 0:e.getTargetingKeys()}getTargeting(e,t){return null==e.getTargeting?void 0:e.getTargeting(t)}sendAdsReport(){const e=this.getPageAdsDataForReport();if(Object.keys(e).length<1)return void alert((0,tt.Z)("ads_report.no_ads"));const[t,i]=(0,a.EQ)(),s={adsData:e,kvData:Object.entries(this.config.keyValues).sort(Fe.h),pageData:{url:window.location.href,pageWidth:t,pageHeight:i}};confirm((0,tt.Z)("ads_report.confirmation_text"))&&(0,st.cZ)("/ads/ads-report",s).then((e=>{if(e.success)alert((0,tt.Z)("ads_report.feedback_message"));else if(!e.success){const t=(0,tt.Z)("ads_report.feedback_message_error");alert(t+"\n"+e.error)}}))}toggleAdsDebugMenu(){this._isAdsDebugPanelOpen?this.closeAdsDebugMenu():this.openAdsDebugMenu()}closeAdsDebugMenu(){const e=document.getElementById(ot);var t;e&&(this._isAdsDebugPanelOpen=!1,null==(t=this._debugRoot)||t.unmount(),e.remove())}openAdsDebugMenu(){const e=this.getPageAdsDataForReport();if(document.getElementsByClassName("AdminDebugBar-inner")[0]&&Object.keys(e).length>0){this._isAdsDebugPanelOpen=!0;const n=document.getElementsByClassName("AdminDebugBar-inner")[0],a=n.parentNode,r=document.createElement("div");r.id=ot,a&&(a.insertBefore(r,n),this._debugRoot=(t=r,s={keyValues:this.config.keyValues,pageAdsData:e,bidReportStartTime:this.bidReportStartTime,amazonBidsData:this.amazonBidsData},(0,i("./app/j/utils/renderReactAppToDOM.tsx").Z)((0,ze.jsx)(Ue,{...s}),t,{skipRenderMark:!0})))}var t,s}getDfpQueryId(e){const t=document.getElementById(e);if(!t)return{};return{dfpQueryId:t.dataset.googleQueryId}}getWinningBidDataForReport(e){const t=this._adEventLogger.getWinningBidsForSlot(e);return t&&t.length?{bidPayload:t.map((e=>["dfp_adv","bidder","dfp_size"].reduce(((t,i)=>e[i]?{...t,[i]:e[i]}:t),{})))}:{}}activateDevMode(){(0,j.yN)(),(0,j.ut)()}deactivateDevMode(){(0,j.Ev)()}hookForPhpAdsLog(e){(0,j._b)(e)}getAdHeadingContainer(e){return document.getElementById((0,a.aV)(e))}getAdsSizesFromCustomMapping(e){if(!this.isRegistered(e))return[];const[t,i]=(0,a.EQ)(),s=this.config.registeredAds[e],[n,r]=B(e,s,{height:i,width:t})[0];return r}getIsBCSEnabled(){var e;return null!=(e=this.config.isBCSEnabled)&&e}shouldUseSafeframe(e){return"teads"!==e.bidder&&("triplelift"!==e.bidder||"tlx"!==e.tl_source)}collapseAdContainer(e){return()=>{const t=document.getElementById(e);t&&(t.style.display="none")}}log(e,t){(0,j.Xq)(e,"QAdManager",t)}}const ht=(e,t,i,s,n,d)=>{var o;const l=(0,a.ZP)(d,"constructor_load_time");let g=!1;if("undefined"!=typeof window){const e=new URLSearchParams(window.location.search);"1"===e.get("qads_debug")&&(g=!0),e.has("campaign")&&(t.keyValues[r.CAMPAIGN]=e.get("campaign"))}const h={...t,...i};+((null==(o=h.user)?void 0:o.id)||0).toString().slice(-1)>2&&(h.keyValues[r.SUBS_OFFER_0523]="1");const u=new gt(e,h,s,n,d),c=t.shouldLogAdRequests;c&&l();const p=(0,a.ZP)(d,"init_load_time");return u.init(),c&&p(),g&&u.activateDevMode(),u};var ut=i("./app/j/ads/compatibility/useQAdManager.ts"),ct=i("./node_modules/react/index.js");const pt=e=>{let{id:t}=e;const i=(0,ut.Z)();return(0,ct.useEffect)((()=>{!(0,ye.ZP)()&&i&&i.displayOutOfPageAd(t)}),[i]),(0,ze.jsx)("div",{id:(0,a.tI)(t)})};function Et(){const[e,t]=(0,ct.useState)([]),i=(0,ut.Z)();return(0,ct.useEffect)((()=>{!(0,ye.ZP)()&&i&&t(i.getOutOfPageAdsSlotNames())}),[i]),(0,ze.jsx)("div",{style:{display:"none"},children:e.map((e=>(0,ze.jsx)(pt,{id:e},e)))})}const _t=ct.memo(Et);const mt=JSON.parse('{"kT":"qz-winning-bids","CK":"qz-clicks-est","hz":2000,"ZD":"https://1b20ai7k0i.quizlet.com/logadevent/v3","J9":15000}'),ft={h846ww:"Conversant",ic2kg0:"DistrictM","3wnojk":"DMX",f07fuo:"Index Exchange","9gfk74":"Magnite",r7pkow:"OpenX","16r2u4g":"PubMatic","1amx5hc":"Sharethrough",xbgn40:"Simpli.fi",vnj2tc:"Sovrn","1mag3k0":"TripleLift","8ch6o0":"UnrulyX_SSP_APS",lnxp1c:"Verizon Media - Marketplace","1qq9log":"Xandr","1oqxhc":"Yahoo Inc"};var At=i("./app/j/ads/utils/rewardedVideoHelper.tsx"),Tt=i("./app/j/utils/unix-timestamp.ts");const St=(e,t)=>(null!==e[t]&&void 0!==e[t]&&(e[t]=Boolean(e[t])),e),vt=(e,t,i)=>{const s=(0,At.MY)();if(!s)return;const n={[s.AdEvent.Type.LOADED]:"ad_slot_video_winning_bid_events",[s.AdEvent.Type.STARTED]:"ad_slot_video_started",[s.AdEvent.Type.FIRST_QUARTILE]:"ad_slot_video_p25_watched",[s.AdEvent.Type.MIDPOINT]:"ad_slot_video_p50_watched",[s.AdEvent.Type.THIRD_QUARTILE]:"ad_slot_video_p75_watched",[s.AdEvent.Type.COMPLETE]:"ad_slot_video_p100_watched",[s.AdEvent.Type.IMPRESSION]:"ad_slot_video_impression",[s.AdEvent.Type.CLICK]:"ad_slot_video_click"}[e];if(!n)throw new Error("table name undefined for "+e);(0,nt.K)(i,n,t,{includeUserDetails:!0,sendSooner:!0})},Rt=(e,t)=>{const i=(e=>{var t;return(null!=(t=e.bids)?t:[]).filter((e=>!e.amzn_bid)).map((t=>({aid:e.aid,...t})))})(t),s=(e=>{var t;const i={...e};if(delete i.created_at,delete i.bids,e.chu){const t=parseFloat(e.chu);Number.isNaN(t)||(i.chu=t)}return St(i,"cpm_est"),St(i,"unfilled"),null!=(t=i.tests)&&t.length&&(i.tests=JSON.stringify(i.tests)),i})(t);(0,nt.K)(e,"ad_slot_winning_bid_events",(0,a.t_)(s),{includeUserDetails:!0,sendSooner:!0}),i.forEach((t=>{(0,nt.K)(e,"ad_slot_received_bid_events",(0,a.t_)(t),{includeUserDetails:!0})}))};var bt=i("./node_modules/lodash/debounce.js"),Pt=i.n(bt);const yt={[mt.kT]:[],[mt.CK]:[]},Ot=e=>{const t=[...yt[e]];yt[e]=[],((e,t)=>{var i;if(0===t.length)return;const s={stream_name:e,events:t},n=JSON.stringify(s,((e,t)=>{if(null!==t)return t})),a=e=>{const t=new XMLHttpRequest;t.open("POST",mt.ZD),t.send(e)};if(null!=(i=navigator)&&i.sendBeacon)try{navigator.sendBeacon(mt.ZD,n)}catch(r){a(n)}else a(n)})(e,t)},Dt=(e,t)=>{e in yt||(yt[e]=[]),yt[e].push(t),Pt()((()=>{Ot(e)}),mt.hz)()};var wt=i("./app/j/utils/log-page-action.ts");function Mt(){(0,ye.ZP)(!1)&&(0,wt.Z)("adblocker_enabled"),(0,ye.ZP)()&&function(){const e=window.document.querySelectorAll(".AdHeading");for(let t=0;t<e.length;t++){const i=e[t];i.parentNode&&i.parentNode.removeChild(i)}}()}var Ct=i("./app/j/ads/components/Ad.tsx"),It=i("./app/j/utils/readReactTarget.ts"),Lt=i("./app/j/utils/renderReactAppToDOM.tsx");var xt=i("./app/j/compatibility/logger/getLoggerConfig.ts"),Bt=i("./node_modules/domready/ready.js"),Nt=i.n(Bt),kt=i("./app/j/global/Quizlet.ts"),Vt=i("./app/j/utils/log-ads-event.ts");(0,ye.on)(!0),function(e){e.googletag=e.googletag||{},e.googletag.cmd=e.googletag.cmd||[]}(n);const Wt={actionString:kt.Z.actionString,countryCode:kt.Z.countryCode,deviceCategory:kt.Z.deviceCategory,shouldLoadPWT:!0,user:kt.Z.user},Ht=new class{constructor(e,t){this._auctionIds={},this._receivedBids={},this._winningBids={},this._winningAids=[],this._onWinningEventCallback=[],this._onAdViewableCallback=[],this._onAdRenderedCallback=[],this._onAdRequestedCallback=[],this._onGPTResponseTimeCallback={},this._lastA9ResponseTime={},this._lastPwtResponseTime={},this.config=e,this.logAdsEvent=t}addLogMetadata(e){this.browserData=e.browserData,this.deviceCategory=e.deviceCategory,this.keyValues=e.keyValues,this.userId=e.userId}resetState(e){this._receivedBids={},this._winningBids={},this.addLogMetadata(e)}addOnAdViewableCallback(e){this._onAdViewableCallback.push(e)}addOnAdRenderedCallback(e){this._onAdRenderedCallback.push(e)}addOnAdRequestedCallback(e){this._onAdRequestedCallback.push(e)}addOnWinningEventCallback(e){this._onWinningEventCallback.push(e)}setupWinningBidLogging(e,t,i){const s=e.pubads();s.addEventListener("slotRenderEnded",(s=>{var n;const a=this._parseGPTSlotRenderEvent(e,s),r=this.getGPTResponseTime(null!=(n=a.ele_id)?n:"");r&&(a.gpt_resp_time=Math.round(r)),this._storeWinningBid(a),t&&Dt(mt.kT,a),i&&Rt(this.config,a),this._triggerOnWinningEvent(a)})),s.addEventListener("impressionViewable",(e=>{var t;const s=e.slot.getSlotElementId(),n=null!=(t=this._winningBids[s])?t:{};if(null!=n&&n.length){var a;const e=this._winningBids[s][n.length-1];i&&null!=(a=e.aid)&&a.length&&(r=this.config,d=e.aid,(0,nt.K)(r,"ad_slot_viewable_events",{aid:d,client_timestamp:(0,Tt.vJ)(),elapsed:Math.floor(window.performance.now())},{sendSooner:!0})),this._triggerOnAdViewable(e)}var r,d})),s.addEventListener("slotOnload",(e=>{var t;const s=e.slot.getSlotElementId(),n=null!=(t=this._winningBids[s])?t:{};if(null!=n&&n.length){var a;const e=this._winningBids[s][n.length-1];i&&null!=(a=e.aid)&&a.length&&(r=this.config,d=e.aid,(0,nt.K)(r,"ad_slot_rendered_bid_events",{aid:d,client_timestamp:(0,Tt.vJ)(),elapsed:Math.floor(window.performance.now())},{sendSooner:!0})),this._triggerOnAdRendered(e)}var r,d})),s.addEventListener("slotRequested",(e=>{const t=e.slot.getSlotElementId(),s=this._getCurrentAuctionId(t),n=this._getEnrolledTests();i&&((e,t,i,s)=>{(0,nt.K)(e,"ad_slot_requested_bid_events",{aid:t,client_timestamp:(0,Tt.vJ)(),tests:i,ele_id:s,elapsed:Math.floor(window.performance.now())},{sendSooner:!0})})(this.config,s,n,t);const a=e.slot.getTargetingKeys().reduce(((t,i)=>(t[i]=e.slot.getTargeting(i),t)),{});this._triggerOnAdRequested({ele_id:t},a)}))}setupClickTracking(e,t){window.addEventListener("blur",(()=>{setTimeout((()=>{var i,s,n;const a=null==(i=document.activeElement)||null==(s=i.parentElement)||null==(n=s.parentElement)?void 0:n.id;if(!a)return;const r=this._winningBids[a];if(!r)return;if(r.length<1)return void(Math.random()<=.01&&ce.Z.warn("Ads: Click Estimation: No matching winning event stored"));const d=r[r.length-1];var o,l;d.aid?(e&&Dt(mt.CK,{...d,created_at:(0,_e.Z)()}),t&&(o=this.config,l=d.aid,(0,nt.K)(o,"ad_slot_click_events",{aid:l,client_timestamp:(0,Tt.vJ)(),elapsed:Math.floor(window.performance.now())},{sendSooner:!0}))):Math.random()<=.01&&ce.Z.warn("Ads: Click Estimation: No aid prop on winning event")}),500)}))}markGPTRequestSent(e){const t=(e,t,i)=>i&&"gpt_response_time"===e?t:null,i=this._winningAids.map((e=>e.aid)).filter(((e,t,i)=>i.indexOf(e)!==t)),s=this._winningAids.filter((e=>i.includes(e.aid)));0!==s.length&&Math.random()<=1e-4&&ce.Z.warn("Ads (0.01%): Duplicate bid for ad slot detected",{winningAids:s,adLogs:(0,j.co)(200,["Flooring"])}),e.forEach((e=>{this._onGPTResponseTimeCallback[e]=(0,a.ZP)(this.logAdsEvent,"gpt_response_time",e,t)}))}setLastA9ResponseTime(e,t){this._lastA9ResponseTime[e]=t}setLastPwtResponseTime(e,t){this._lastPwtResponseTime[e]=t}getLastA9ResponseTime(e){if(e.startsWith("php-"))try{return Math.round(window.performance.measure("php-ads-a9-auc-measure","php-ads-a9-auc-start","php-ads-a9-auc-end").duration)}catch(i){Math.random()<=.01&&ce.Z.warn("Ads (1%): Performance.measure: Given mark name, php-ads-a9-auc-end, is unknown",{adBlockEnabled:(0,ye.ZP)(!1),adLogs:(0,j.co)(200,["Flooring"])})}const t=this._lastA9ResponseTime[e]?Math.round(this._lastA9ResponseTime[e]):null;return delete this._lastA9ResponseTime[e],t}getLastPwtResponseTime(e){if(e.startsWith("php-"))try{return Math.round(window.performance.measure("php-ads-pwt-auc-measure","php-ads-pwt-auc-start","php-ads-pwt-auc-end").duration)}catch(i){Math.random()<=.01&&ce.Z.warn("Ads (1%): Performance.measure: Given mark name, php-ads-pwt-auc-end, is unknown",{adBlockEnabled:(0,ye.ZP)(!1),adLogs:(0,j.co)(200,["Flooring"])})}const t=this._lastPwtResponseTime[e]?Math.round(this._lastPwtResponseTime[e]):null;return delete this._lastPwtResponseTime[e],t}getGPTResponseTime(e){if(e.startsWith("php-")){const r=e+"-gpt-start";try{var t,i,s,n;return null!=(t=null==(i=window)||null==(s=i.performance)||null==(n=s.measure(e+"-gpt-measure",r))?void 0:n.duration)?t:null}catch(a){Math.random()<=.01&&ce.Z.warn("Ads (1%): Performance.measure: Given mark name, "+r+", is unknown",{adBlockEnabled:(0,ye.ZP)(!1),adLogs:(0,j.co)(200,["Flooring"])})}}else if(this._onGPTResponseTimeCallback[e])return this._onGPTResponseTimeCallback[e]();return null}getAids(){return this._winningAids.map((e=>e.aid))}logOpenWrapBid(e){var t;if(e.cpm<=0)return;const i=this._getCurrentAuctionId(e.adUnitCode);i in this._receivedBids||(this._receivedBids[i]=[]);const s={bidder:e.bidder,cpm:e.cpm,elapsed:Math.floor(window.performance.now()),resp_time:e.timeToRespond,size:e.size};e.bidder in te||(s.req_flr=e._requestFloor,s.req_flr_r=e._requestFloorRespected);const n=(null==(t=e.adserverTargeting)?void 0:t.hb_adomain)||"";n.length>0&&(s.domain=n),this.log("↪ Received bid "+e.bidder+"["+e.adUnitCode+"] -> $"+e.cpm+" after "+e.timeToRespond+"ms",{size:e.size,domain:s.domain,aid:i}),this._receivedBids[i].push(s)}logAmazonBid(e){var t;const i=(0,a.tI)(e.name),s=this._getCurrentAuctionId(i),n=!!(null==(t=e.targeting.amzniid_sp)?void 0:t[0]);s in this._receivedBids||(this._receivedBids[s]=[]);const r={bidder:ft[e.targeting.amznp]?e.bidder+"_"+ft[e.targeting.amznp]:e.bidder,amzn_bid:n?e.targeting.amznbid_sp:e.targeting.amznbid};this._receivedBids[s].push(r)}getWinningBidsForSlot(e){return this._winningBids[e]}resetAuctionIds(e){e.filter((e=>e in this._auctionIds)).forEach((e=>delete this._auctionIds[e]))}_parseGPTSlotRenderEvent(e,t){const i=t.slot.getSlotElementId(),s=t.isEmpty,n=(d=t.size,Array.isArray(d)&&2===d.length?d[0]+"x"+d[1]:null);var d;const o=t.slot.getTargeting(r.AD_REFRESH_COUNT)[0],l=t.slot.getTargeting(Xe.CUSTOM_HARD_UPR),g=l.length>0?l[0]:null,h=parseFloat(g||"0")||0,u=(new He.Z).getItem(Me.Vj),c=this.browserData,p=this._getCurrentAuctionId(i),E=[...this._receivedBids[p]||[]],_=E.filter((e=>e.amzn_bid)),m=ke();let f={a9_auc_time:this.getLastA9ResponseTime(i),aid:p,amzn_bidder:_.length>0?_[0].bidder:null,amzn_bid:_.length>0?_[0].amzn_bid:null,bids:E.length?E:null,bidder:null,bn:(null==c?void 0:c.browserName)||null,bv:(null==c?void 0:c.browserVersion)||null,chu:g,dc:this.deviceCategory,dl:m.dl?parseInt(m.dl,10):null,cpm:null,cpm_est:null,created_at:(0,_e.Z)(),dfp_adv:null,dfp_size:n,elapsed:Math.floor(window.performance.now()),ele_id:i,geoc:(null==c?void 0:c.countryCode)||null,geom:(null==c?void 0:c.regionCode)||null,lid:t.lineItemId?t.lineItemId.toString():null,osn:(null==c?void 0:c.osName)||null,osv:(null==c?void 0:c.osVersion)||null,pd:u?parseInt(u,10):null,pmp:!1,pwt_auc_time:this.getLastPwtResponseTime(i),ref:parseInt(o,10)||null,rtt:m.rtt?parseInt(m.rtt,10):null,tests:this._getEnrolledTests(),unfilled:s?H.G9.UNFILLED:H.G9.FILLED,uid:this.userId,url:window.location.href};if(delete this._receivedBids[p],!s){const e=(0,a.Lg)(""+t.advertiserId)||""+t.advertiserId;f=Object.assign(f,{dfp_adv:e});const s=this._capturePositionalData(i);f=Object.assign(f,s);const n=(0,a.Mk)(i,!0)[0]||{bidder:null,netEcpm:0},r=!(!n.dealID||void 0===n.dealID);if("PubMatic"===e)f=Object.assign(f,{bidder:n.adapterID,cpm:n.netEcpm,cpm_est:H.GO.EXACT,pmp:r});else{let i=Math.max(n.netEcpm,h)+.01;if(i=Math.round(100*i)/100,f=Object.assign(f,{cpm:i,cpm_est:H.GO.ESTIMATED}),"Amazon/A9"===e){const e=t.slot.getTargeting("amzniid_sp")[0],i=!(!e||void 0===e);f.bidder=this._getTAMBidder(t.slot),f.pmp=i}}}return f}_getTAMBidder(e){const t=e.getTargeting("amznp")[0];return t?ft[t]:"amazon"}_storeWinningBid(e){e.ele_id&&(this._winningBids[e.ele_id]||(this._winningBids[e.ele_id]=[]),this._winningBids[e.ele_id].push({...e}),e.aid&&this._winningAids.push({aid:e.aid,bidder:e.bidder||"None",bids:e.bids||"None",ele_id:e.ele_id}))}_getEnrolledTests(){return Object.entries(this.keyValues).filter((e=>e[0].startsWith("adexp"))).map((e=>e[0]+"_"+e[1]))}_getCurrentAuctionId(e){const t=we.getCurrentAid(e);return null!=t&&t.length?t:((!(e in this._auctionIds)||(0,_e.Z)()-this._auctionIds[e].created_at>mt.J9)&&(this._auctionIds[e]={aid:(0,De.Z)(),created_at:(0,_e.Z)()}),this._auctionIds[e].aid)}_capturePositionalData(e){if(null==e||!e.length)return{};const t=(0,Be.getHeight)(),i=(0,Be.getWidth)();let s=null,n=null,a=null;const r=document.getElementById(e),d=null==r?void 0:r.getBoundingClientRect();return d?(n=Math.round(d.left+window.scrollX),a=Math.round(d.top+window.scrollY),s=(null==d?void 0:d.top)>=0&&(null==d?void 0:d.left)>=0&&(null==d?void 0:d.bottom)<=t&&(null==d?void 0:d.right)<=i):Math.random()<=1e-4&&ce.Z.warn("Ads (0.01%): AdEventLogger could not grab positional data",{eleId:e,viewportHeight:t,viewportWidth:i}),{inV:s,posX:n,posY:a,vH:Math.round(t),vW:Math.round(i)}}_triggerOnAdViewable(e){this.log("👀 "+e.ele_id+" is viewable"),this._onAdViewableCallback.length&&this._onAdViewableCallback.forEach((t=>t(e)))}_triggerOnAdRendered(e){this.log("Creative rendered",{eleId:e.ele_id}),this._onAdRenderedCallback.length&&this._onAdRenderedCallback.forEach((t=>t(e)))}_triggerOnAdRequested(e,t){this.log("Ad requested",{ele_id:e.ele_id,kvs:t}),this._onAdRequestedCallback.length&&this._onAdRequestedCallback.forEach((t=>t(e)))}_triggerOnWinningEvent(e){e.unfilled===H.G9.UNFILLED?this.log("✅ no fill ["+e.ele_id+"]",{aid:e.aid}):this.log("✅ rendered "+e.dfp_adv+(e.bidder?" - ":"")+(e.bidder?e.bidder:"")+" ["+e.ele_id+"] -> $"+e.cpm+" after "+e.gpt_resp_time+"ms",{aid:e.aid,size:e.dfp_size}),this._onWinningEventCallback.length&&this._onWinningEventCallback.forEach((t=>t(e)))}setupVideoEventsLogging(e,t,i){const s=(0,At.MY)();if(!s)return;[s.AdEvent.Type.LOADED,s.AdEvent.Type.STARTED,s.AdEvent.Type.FIRST_QUARTILE,s.AdEvent.Type.MIDPOINT,s.AdEvent.Type.THIRD_QUARTILE,s.AdEvent.Type.COMPLETE,s.AdEvent.Type.IMPRESSION,s.AdEvent.Type.CLICK].forEach((s=>{i.addEventListener(s,(i=>{const n=this._parseIMAEvent(e,t,s,!1,i);vt(s,n,this.config)}))}))}logVideoUnfill(e,t){const i=(0,At.MY)(),s=(null==i?void 0:i.AdEvent.Type.LOADED)||"loaded",n=this._parseIMAEvent(e,t,s,!0);vt(s,n,this.config)}_parseIMAEvent(e,t,i,s,n){const a=(0,At.MY)(),r=null==n?void 0:n.getAd(),d=this.browserData,o=ke(),l=this._capturePositionalData(t),g=(new He.Z).getItem(Me.Vj);let h={aid:e,ad_id:(null==r?void 0:r.getAdId())||null,created_at:(0,_e.Z)(),elapsed:Math.floor(window.performance.now()),ele_id:t,tests:this._getEnrolledTests(),uid:this.userId||null,url:window.location.href,unfilled:s,...l};return i===(null==a?void 0:a.AdEvent.Type.LOADED)&&(h={...h,bn:(null==d?void 0:d.browserName)||null,bv:(null==d?void 0:d.browserVersion)||null,cr_id:(null==r?void 0:r.getCreativeId())||null,dc:this.deviceCategory,dl:o.dl?parseInt(o.dl,10):null,geoc:(null==d?void 0:d.countryCode)||null,geom:(null==d?void 0:d.regionCode)||null,height:(null==r?void 0:r.getVastMediaHeight())||null,osn:(null==d?void 0:d.osName)||null,osv:(null==d?void 0:d.osVersion)||null,pd:g?parseInt(g,10):null,rtt:o.rtt?parseInt(o.rtt,10):null,title:(null==r?void 0:r.getTitle())||null,width:(null==r?void 0:r.getVastMediaHeight())||null}),h}log(e,t){(0,j.Xq)(e,"AdEventLogger",t)}}((0,xt.c)(),Vt.Z);var jt;kt.Z.QAdManager=ht(n.googletag,kt.Z.adConfig,Wt,s.Z,Ht,Vt.Z),(0,j.Zb)(),QLoad("Quizlet.Ads"),Nt()((()=>{Mt(),kt.Z.QAdManager.shouldRenderOutOfPageSlots()&&(0,It.Z)("OutOfPageAds",!1).then((e=>{let{target:t}=e;(0,Lt.Z)((0,ze.jsx)(_t,{}),t)}))})),jt=kt.Z.adConfig.registeredAds,Object.keys(jt).forEach((e=>{jt[e].isPHPRendered&&(0,It.Z)("SiteAd"+e).then((e=>{let{target:t,data:i}=e;return(0,Lt.Z)((0,ze.jsx)(Ct.Z,{...i}),t)}))}))},"./app/j/ads/constants/adConstants.ts":(e,t,i)=>{"use strict";i.d(t,{If:()=>s,O8:()=>n,Vj:()=>a,lw:()=>o,mW:()=>r,sV:()=>d});const s=30,n=7,a="ads-page-depth",r=3,d=5,o=5e3},"./app/j/ads/enums/RefreshReason.ts":(e,t,i)=>{"use strict";let s;i.d(t,{q:()=>s}),function(e){e[e.ACTION_REFRESH=0]="ACTION_REFRESH",e[e.MOUNT_REFRESH=1]="MOUNT_REFRESH",e[e.RESIZE_REFRESH=2]="RESIZE_REFRESH",e[e.TIME_REFRESH=3]="TIME_REFRESH"}(s||(s={}))},"./app/j/ads/sizes/video.ts":(e,t,i)=>{"use strict";i.d(t,{x:()=>s});const s={ad300x250v:[300,250],ad300x600v:[300,600],ad400x300v:[400,300],ad480x270v:[480,270],ad640x360v:[640,360]}},"./app/j/ads/utils/adsDebugToolUtils.ts":(e,t,i)=>{"use strict";i.d(t,{I:()=>n,h:()=>s});i("./node_modules/core-js/modules/es.array.iterator.js"),i("./node_modules/core-js/modules/web.dom-collections.iterator.js"),i("./node_modules/core-js/modules/es.array.reduce.js"),i("./node_modules/core-js/modules/es.array.sort.js");const s=(e,t)=>{let[i]=e,[s]=t;return i>s?1:s>i?-1:0},n=function(e){return void 0===e&&(e={}),Object.entries(e).sort(s).reduce(((e,t)=>{let[i,s]=t;return""+e+i+": "+s+", "}),"")}},"./app/j/ads/utils/rewardedVideoHelper.tsx":(e,t,i)=>{"use strict";i.d(t,{MY:()=>l,V9:()=>c});var s=i("./app/j/ads/enums/AdsNames.ts");const n={[s.h.LEARN_REWARDED_VIDEO]:{VastTagUrl:"https://pubads.g.doubleclick.net/gampad/ads?iu=/6396803/Learn_Rewarded_Video&description_url=[placeholder]&tfcd=0&npa=0&gdfp_req=1&output=vast&unviewed_position_start=1&env=vp&impl=s&correlator=",sizes:{vertical:"576x720",remaining:"854x480"}},[s.h.MINI_FC_REWARDED_VIDEO]:{VastTagUrl:"https://pubads.g.doubleclick.net/gampad/ads?iu=/6396803/MiniModeRVA&description_url=[placeholder]&tfcd=0&npa=0&gdfp_req=1&output=vast&unviewed_position_start=1&env=vp&impl=s&correlator=",sizes:{remaining:"854x480"}}};var a=i("./app/j/global/Rollbar.ts"),r=i("./node_modules/uuid/dist/esm-browser/v4.js");const d=5/4,o=9/16,l=()=>{var e;const t=window;return null==t||null==(e=t.google)?void 0:e.ima},g=e=>"cust_params=".concat(encodeURIComponent(Object.keys(e).map((t=>{return[t,(i=e[t],"string"==typeof i?i:i.join(","))].join("=");var i})).join("&"))),h=(e,t)=>"sz=".concat(t&&e.vertical?e.vertical:e.remaining),u=(e,t,i)=>{return[e.VastTagUrl,g(t),h(e.sizes,i),e.companionSlots?(s=e.companionSlots,s?"ciu_szs=".concat(Object.keys(s).map((e=>{const t=s[e];return[t.width,t.height].join("x")})).join(",")):""):""].join("&");var s},c=e=>{var t;let{adContainer:i,adManager:s,adName:g,soundControl:h,onVideoCompletion:c,updateVideoAdCountdownSeconds:p,verticalPlayer:E=!1}=e;const _=l();if(!_)return a.Z.error(new Error("Ads: RVA: ima sdk not ready"),{test:"LearnModeRVA"}),void c();if(!i)return a.Z.error(new Error("Ads: RVA: container not on page"),{test:"LearnModeRVA"}),void c();const m=s._adEventLogger,f=s.config.keyValues,A=(null==s?void 0:s.config.shouldLogWinningVideoBidsToBQ)||!1,T=n[g];let S;const v=new _.AdDisplayContainer(i,S),R=new _.AdsLoader(v),b=new _.AdsRequest,P=(0,r.Z)();R.addEventListener(_.AdErrorEvent.Type.AD_ERROR,(e=>{e.getError().getErrorCode()===_.AdError.ErrorCode.VAST_EMPTY_RESPONSE?A&&(null==m||m.logVideoUnfill(P,i.id||"LearnModeRVA")):Math.random()<=1e-4&&a.Z.warn(new Error("Ads: RVA: (0.01%) ".concat(e.getError().toString())),{test:"LearnModeRVA",adTag:u(T,f,E)}),c()}),!1);const y=E&&(null==(t=i.parentElement)?void 0:t.offsetWidth)||854,O=E?d*y:o*y;if(h){const e=h.muteButton;e.style.position="absolute",e.style.top=(O+19).toString().concat("px"),e.style.marginLeft=(y-38).toString().concat("px")}b.adTagUrl=u(T,f,E),b.linearAdSlotWidth=y,b.linearAdSlotHeight=O,R.addEventListener(_.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>{const t=e.getAdsManager(S);let s;t.addEventListener(_.AdErrorEvent.Type.AD_ERROR,(e=>{Math.random()<=1e-4&&a.Z.warn(new Error("Ads: RVA: (0.01%) ".concat(e.getError().toString())),{test:"LearnModeRVA"}),c()})),A&&(null==m||m.setupVideoEventsLogging(P,i.id||"LearnModeRVA",t)),t.addEventListener(_.AdEvent.Type.LOADED,(e=>{s=e.getAdData().clickThroughUrl})),h&&(h.muteButton.onclick=()=>{1===t.getVolume()?(h.setMuted(!0),t.setVolume(0)):(h.setMuted(!1),t.setVolume(1))},t.setVolume(h.muted?0:1)),T.companionSlots&&t.addEventListener(_.AdEvent.Type.STARTED,(e=>{const t=e.getAd(),i=new _.CompanionAdSelectionSettings;if(i.resourceType=_.CompanionAdSelectionSettings.ResourceType.STATIC,i.creativeType=_.CompanionAdSelectionSettings.CreativeType.IMAGE,i.sizeCriteria=_.CompanionAdSelectionSettings.SizeCriteria.IGNORE,t){const e=T.companionSlots;Object.keys(e).forEach((s=>{const n=e[s],a=t.getCompanionAds(n.width,n.height,i);a&&a.forEach((e=>{const t=e.getContent(),i=document.getElementById("dfp-"+s);i&&(i.innerHTML=t)}))}))}})),t.init(y,O,_.ViewMode.NORMAL),t.start(),t.addEventListener(_.AdEvent.Type.PAUSED,(()=>{t.resume(),E&&window.open(s)})),t.addEventListener(_.AdEvent.Type.COMPLETE,(()=>{c()})),p&&t.addEventListener(_.AdEvent.Type.AD_PROGRESS,(e=>{const t=e.getAdData(),i=Math.floor(t.duration)-Math.floor(t.currentTime);p(i)}))}),!1),R.requestAds(b),v.initialize()}},"./app/j/ads/utils/screenSizes.ts":(e,t,i)=>{"use strict";i.d(t,{r:()=>a});var s=i("./app/j/constants/BreakpointConstants.ts");const n=e=>(0,s.hQ)(e,1)||0,a={veryLarge:[n("xl"),0],largeAndVeryTall:[n("l"),910],largeAndTall:[n("l"),750],large:[n("l"),0],mediumAndVeryTall:[n("m"),910],medium:[n("m"),0],small:[n("s"),0],verySmall:[n("xs"),0],tiny:[n("xxs"),300],remaining:[0,0]}},"./app/j/config/constants.ts":(e,t,i)=>{"use strict";i.d(t,{HW:()=>n,ZP:()=>s,cD:()=>a,nw:()=>r,oA:()=>d});const s={EMAIL_MAX_LENGTH:127,fallbackTimeZone:"America/Los_Angeles",IMPRESSED_PERCENTAGE_THRESHOLD:10,MAX_TERMS_FOR_PRINT:500,NETWORK_CODE:"6396803",ONE_TRUST_KEY:"c477f242-a93f-4a62-9585-05c0f39fc61d",ONE_TRUST_TEST_KEY:"cdb8b302-c332-452d-aa57-157909d81d26-test",TEACHER_MAX_AGE:80,TEACHER_MIN_AGE:20,SEARCH_QUERY_MAX_CHARS:100},n="6396803",a=80,r=20,d=100},"./app/j/utils/LocalStorageHelper.ts":(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});class s{constructor(){this.enabled=!0;try{this.storage=window.localStorage}catch(e){try{this.storage=window.sessionStorage}catch(t){this.enabled=!1}}}getItem(e){return this.storage?this.storage.getItem(e):null}setItem(e,t){if(this.storage)try{this.storage.setItem(e,t)}catch(i){}}removeItem(e){this.storage&&this.storage.removeItem(e)}isEnabled(){return this.enabled}}},"./app/j/utils/sampleAt.ts":(e,t,i)=>{"use strict";function s(e,t){if(Math.random()<e)return t()}i.d(t,{Z:()=>s})},"./node_modules/lodash/_baseNth.js":(e,t,i)=>{var s=i("./node_modules/lodash/_isIndex.js");e.exports=function(e,t){var i=e.length;if(i)return s(t+=t<0?i:0,i)?e[t]:void 0}},"./node_modules/lodash/defaultTo.js":e=>{e.exports=function(e,t){return null==e||e!=e?t:e}},"./node_modules/lodash/groupBy.js":(e,t,i)=>{var s=i("./node_modules/lodash/_baseAssignValue.js"),n=i("./node_modules/lodash/_createAggregator.js"),a=Object.prototype.hasOwnProperty,r=n((function(e,t,i){a.call(e,i)?e[i].push(t):s(e,i,[t])}));e.exports=r},"./node_modules/lodash/nth.js":(e,t,i)=>{var s=i("./node_modules/lodash/_baseNth.js"),n=i("./node_modules/lodash/toInteger.js");e.exports=function(e,t){return e&&e.length?s(e,n(t)):void 0}}},e=>{e.O(0,["react","common"],(()=>{return t="./app/j/ads/ads.entry.tsx",e(e.s=t);var t}));e.O()}]);